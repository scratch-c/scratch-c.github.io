<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ åˆ åº“è·‘è·¯âš¡</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Courier New', Courier, monospace;
        }
        body {
            background: linear-gradient(145deg, #0b1f1a 0%, #0a2a1f 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        .game-container {
            max-width: 1100px;
            width: 100%;
            background: #0f0e0b;
            border-radius: 24px;
            box-shadow: 0 20px 35px rgba(0,0,0,0.8), 0 0 0 2px #3a5f4b inset, 0 0 0 4px #1e332a inset;
            padding: 24px 20px 28px;
            border: 2px solid #6f8f72;
        }
        .terminal-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-left: 8px;
            border-bottom: 2px solid #3b6e4b;
            padding-bottom: 10px;
        }
        .terminal-header .dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2e7d5a;
            box-shadow: 0 0 0 2px #5faa7a;
        }
        .terminal-header .dot.red {
            background: #ac4e3b;
            box-shadow: 0 0 0 2px #d47b62;
        }
        .terminal-header .dot.yellow {
            background: #c9a23b;
            box-shadow: 0 0 0 2px #ebc454;
        }
        .terminal-header .title {
            color: #b3f0c0;
            font-size: 1.4rem;
            font-weight: bold;
            letter-spacing: 2px;
            text-shadow: 0 0 5px #71c285;
            flex: 1;
            text-align: center;
            margin-right: 50px;
        }
        
        /* éš¾åº¦é€‰æ‹©å™¨ */
        .difficulty-selector {
            background: #0f271b;
            border: 2px solid #3f7854;
            border-radius: 16px;
            padding: 12px 16px;
            margin-bottom: 20px;
            color: #b3f0c0;
        }
        .difficulty-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }
        .difficulty-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .difficulty-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            border: 2px solid;
            border-radius: 30px;
            background: #0c1f17;
            color: #c6f7d0;
            font-weight: bold;
            cursor: pointer;
            transition: 0.1s;
            text-align: center;
        }
        .difficulty-btn.easy {
            border-color: #4f9e6a;
        }
        .difficulty-btn.easy.selected {
            background: #1f6e3a;
            border-color: #a6ffb4;
            box-shadow: 0 0 10px #5aff8c;
        }
        .difficulty-btn.normal {
            border-color: #d4a13e;
        }
        .difficulty-btn.normal.selected {
            background: #b37b2c;
            border-color: #ffd966;
            box-shadow: 0 0 10px #ffb347;
        }
        .difficulty-btn.hard {
            border-color: #c45a3b;
        }
        .difficulty-btn.hard.selected {
            background: #a13e2b;
            border-color: #ff8a6c;
            box-shadow: 0 0 10px #ff5f4a;
        }
        .difficulty-btn.hell {
            border-color: #9b3b9b;
        }
        .difficulty-btn.hell.selected {
            background: #6b2b6b;
            border-color: #d86cd8;
            box-shadow: 0 0 10px #bf3fbf;
        }
        .difficulty-btn.ultimate {
            border-color: #ff0000;
            text-shadow: 0 0 5px #ff0000;
        }
        .difficulty-btn.ultimate.selected {
            background: #8b0000;
            border-color: #ff6666;
            box-shadow: 0 0 15px #ff0000;
        }
        .difficulty-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #89f7b1;
            background: #0c1f17;
            padding: 8px 12px;
            border-radius: 30px;
            border: 1px solid #3f7854;
        }
        
        /* æˆå°±é¢æ¿ */
        .achievement-panel {
            background: #0f271b;
            border: 2px solid #3f7854;
            border-radius: 16px;
            padding: 12px 16px;
            margin-bottom: 20px;
            color: #b3f0c0;
        }
        .achievement-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
        }
        .achievement-title:hover {
            color: #e3ffe7;
        }
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }
        .achievement-grid::-webkit-scrollbar {
            width: 6px;
            background: #193126;
        }
        .achievement-grid::-webkit-scrollbar-thumb {
            background: #45996b;
            border-radius: 30px;
        }
        .achievement-item {
            background: #0c1f17;
            border: 1px solid #2d6b42;
            border-radius: 12px;
            padding: 6px 3px;
            text-align: center;
            font-size: 0.8rem;
            transition: 0.1s;
        }
        .achievement-item.unlocked {
            background: #1f5a36;
            border-color: #a6ffb4;
            color: #e3ffe7;
            box-shadow: 0 0 8px #5aff8c;
        }
        .achievement-item .emoji {
            font-size: 1.2rem;
            display: block;
        }
        .achievement-item .name {
            font-weight: bold;
            font-size: 0.7rem;
        }
        .achievement-item .desc {
            font-size: 0.6rem;
            color: #89c297;
        }
        .achievement-item.unlocked .desc {
            color: #dcffd3;
        }
        .stats-row {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: #89f7b1;
        }
        .progress-bar {
            background: #0a1f15;
            height: 6px;
            border-radius: 6px;
            margin: 10px 0 5px;
        }
        .progress-fill {
            background: #6eff96;
            height: 6px;
            border-radius: 6px;
            width: 0%;
            transition: width 0.3s;
        }
        
        .screen {
            background: #0c1f17;
            border: 3px solid #3c6e51;
            border-radius: 18px;
            padding: 20px 18px;
            min-height: 350px;
            box-shadow: inset 0 0 25px #00000099, 0 0 0 2px #5d8867;
            color: #c6f7d0;
            font-size: 1.15rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
            margin-bottom: 20px;
            overflow-y: auto;
            max-height: 400px;
            scroll-behavior: smooth;
        }
        .screen::-webkit-scrollbar {
            width: 8px;
            background: #193126;
        }
        .screen::-webkit-scrollbar-thumb {
            background: #45996b;
            border-radius: 30px;
        }
        .input-area {
            background: #0b1d13;
            border-radius: 60px;
            border: 3px solid #4a7b5c;
            display: flex;
            align-items: center;
            padding: 6px 18px;
            margin-top: 12px;
            box-shadow: 0 0 0 2px #1f4a30 inset;
        }
        .prompt {
            color: #d0ffb0;
            font-weight: bold;
            font-size: 1.5rem;
            margin-right: 10px;
            text-shadow: 0 0 8px #9affb0;
        }
        #commandInput {
            background: transparent;
            border: none;
            outline: none;
            color: #e3ffe7;
            font-size: 1.4rem;
            width: 100%;
            caret-color: #66ff99;
            font-family: 'Courier New', Courier, monospace;
            font-weight: 500;
        }
        #commandInput::placeholder {
            color: #456b52;
            font-size: 1.1rem;
            font-style: italic;
        }
        .button-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
            justify-content: center;
        }
        .cmd-btn {
            background: #193d29;
            border: 2px solid #6cab7c;
            color: #dcffd3;
            font-size: 0.9rem;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 40px;
            cursor: pointer;
            transition: 0.15s;
            font-family: 'Courier New', monospace;
            box-shadow: 0 5px 0 #0e251a;
            text-transform: lowercase;
        }
        .cmd-btn:hover {
            background: #256b40;
            border-color: #9effb4;
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #0e251a;
        }
        .cmd-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #0e251a;
        }
        .status-bar {
            display: flex;
            justify-content: space-between;
            color: #89f7b1;
            margin: 15px 5px 5px 5px;
            font-size: 1.2rem;
            font-weight: bold;
            background: #0f271b;
            padding: 8px 18px;
            border-radius: 40px;
            border: 1px solid #3f7854;
        }
        .danger {
            color: #ff907c;
            text-shadow: 0 0 5px #ff5f4a;
        }
        .warning {
            color: #ffb27a;
        }
        .safe {
            color: #c6f7d0;
        }
        .admin-alert {
            color: #ff4444;
            text-shadow: 0 0 10px #ff0000;
            font-weight: bold;
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .reset-link {
            text-align: right;
            margin-top: 10px;
        }
        .reset-link button {
            background: none;
            border: 2px solid #4e7760;
            color: #a8e6b3;
            font-size: 1rem;
            padding: 5px 18px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.1s;
        }
        .reset-link button:hover {
            background: #2d5f40;
            color: white;
        }
        .footer-note {
            color: #50855e;
            text-align: center;
            margin-top: 12px;
            font-size: 0.9rem;
        }
        .admin-status {
            background: #2d1f1f;
            border: 1px solid #ff6666;
            border-radius: 30px;
            padding: 4px 12px;
            display: inline-block;
            color: #ffaaaa;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
<div class="game-container">
    <div class="terminal-header">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot"></span>
        <span class="title">rm -rf / â˜… 30æˆå°±å®Œæ•´ç‰ˆ</span>
    </div>

    <!-- éš¾åº¦é€‰æ‹©å™¨ - é»˜è®¤ç®€å• -->
    <div class="difficulty-selector">
        <div class="difficulty-title">
            <span>âš¡ é€‰æ‹©éš¾åº¦ <span id="difficultyName">ç®€å•</span></span>
            <span>ğŸ† æˆå°± <span id="unlockCount">0/30</span></span>
        </div>
        <div class="difficulty-buttons">
            <div class="difficulty-btn easy selected" data-difficulty="easy" onclick="setDifficulty('easy')">ğŸƒ ç®€å•</div>
            <div class="difficulty-btn normal" data-difficulty="normal" onclick="setDifficulty('normal')">ğŸŒ² æ™®é€š</div>
            <div class="difficulty-btn hard" data-difficulty="hard" onclick="setDifficulty('hard')">ğŸ”¥ å›°éš¾</div>
            <div class="difficulty-btn hell" data-difficulty="hell" onclick="setDifficulty('hell')">ğŸ‘¿ åœ°ç‹±</div>
            <div class="difficulty-btn ultimate" data-difficulty="ultimate" onclick="setDifficulty('ultimate')">ğŸ’€ ç©¶æåœ°ç‹±</div>
        </div>
        <div class="difficulty-info" id="difficultyInfo">
            ğŸƒ ç®€å•: åˆå§‹é£é™©10%ï¼Œéšè”½å¯ç”¨5æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+1%/30ç§’
        </div>
    </div>

    <!-- æˆå°±é¢æ¿ -->
    <div class="achievement-panel" id="achievementPanel">
        <div class="achievement-title" onclick="toggleAchievements()">
            <span>ğŸ† æˆå°±ç³»ç»Ÿ <span id="unlockCount2">0/30</span></span>
            <span id="toggleIcon">â–¼</span>
        </div>
        <div id="achievementContent">
            <div class="stats-row">
                <span>ğŸƒ æ€»æ¸¸æˆæ¬¡æ•°: <span id="totalGames">0</span></span>
                <span>âœ¨ Sçº§ç»“å±€: <span id="sRankCount">0</span></span>
                <span>ğŸ’€ ä½œæ­»æ¬¡æ•°: <span id="deathCount">0</span></span>
            </div>
            <div class="achievement-grid" id="achievementGrid">
                <!-- æˆå°±å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
        </div>
    </div>

    <!-- ä¸»å±å¹•è¾“å‡º -->
    <div class="screen" id="outputScreen">
        > ç³»ç»Ÿå¯åŠ¨ä¸­...
        > æ‚¨å·²é€šè¿‡è·³æ¿æœºè¿æ¥åˆ°ç”Ÿäº§ç¯å¢ƒ [10.0.0.1]
        >
        âš ï¸  å½“å‰ç›®å½•: /data/production/db
        âš ï¸  å½“å‰éš¾åº¦: ç®€å•
        >
        è¾“å…¥æŒ‡ä»¤å¼€å§‹ä½ çš„åˆ åº“è·‘è·¯è®¡åˆ’...
    </div>

    <!-- è¾“å…¥è¡Œ -->
    <div class="input-area">
        <span class="prompt">$</span>
        <input type="text" id="commandInput" placeholder="è¾“å…¥å‘½ä»¤ (help)" autofocus>
    </div>

    <!-- å¿«æ·æŒ‡ä»¤æŒ‰é’® - å¸¦éš¾åº¦åˆ†ç±» -->
    <div class="button-grid" id="buttonGrid">
        <!-- åŸºç¡€æŒ‰é’® - æ‰€æœ‰éš¾åº¦éƒ½æ˜¾ç¤º -->
        <button class="cmd-btn base-btn" data-cmd="ls -la">ğŸ“ ls -la</button>
        <button class="cmd-btn base-btn" data-cmd="rm -rf ./data">ğŸ’£ rm -rf ./data</button>
        <button class="cmd-btn base-btn" data-cmd="sudo su">ğŸ” sudo su</button>
        <button class="cmd-btn base-btn" data-cmd="cat config.json">ğŸ“„ cat config</button>
        <button class="cmd-btn base-btn" data-cmd="cat secret.db">ğŸ”‘ cat secret</button>
        <button class="cmd-btn base-btn" data-cmd="rm -f .hidden_audit">ğŸ—‘ï¸ åˆ å®¡è®¡</button>
        <button class="cmd-btn base-btn" data-cmd="history -c">ğŸ§¹ æ¸…å†å²</button>
        <button class="cmd-btn base-btn" data-cmd="hide">ğŸ‘» éšè”½</button>
        <button class="cmd-btn base-btn" data-cmd="run">ğŸƒ è·‘è·¯ï¼</button>
        
        <!-- ç©¶æåœ°ç‹±ä¸“å±æŒ‰é’® - åªæœ‰ç©¶æéš¾åº¦æ˜¾ç¤º -->
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="ssh backup">ğŸ–¥ï¸ ssh backup</button>
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="ssh replica">ğŸ–¥ï¸ ssh replica</button>
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="ssh archive">ğŸ–¥ï¸ ssh archive</button>
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="ssh log">ğŸ–¥ï¸ ssh log</button>
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="verify">ğŸ“± åŒå› ç´ éªŒè¯</button>
        <button class="cmd-btn ultimate-btn ultimate-only" data-cmd="who">ğŸ‘¥ who</button>
    </div>

    <!-- çŠ¶æ€æ  -->
    <div class="status-bar">
        <span>ğŸ”¥ é£é™©: <span id="riskValue" class="safe">10</span>%</span>
        <span>â³ æ—¶é—´: <span id="timerDisplay">5:00</span></span>
        <span class="admin-status" id="adminStatus" style="display: none;">ğŸ‘¤ ç®¡ç†å‘˜: åœ¨çº¿</span>
    </div>

    <!-- é‡ç½®æŒ‰é’® -->
    <div class="reset-link">
        <button id="resetBtn">âŸ² é‡æ–°è¿æ¥</button>
        <button id="clearAchievementsBtn" style="margin-left: 10px; background: #3d2b2b; border-color: #aa6a6a;">ğŸ—‘ï¸ æ¸…ç©ºæˆå°±</button>
    </div>
    <div class="footer-note">[ 30æˆå°±å®Œæ•´ç‰ˆ ] â€” 30ä¸ªæˆå°±å¯æ­£å¸¸æ˜¾ç¤ºï¼ŒæŒ‰é’®éšéš¾åº¦å˜åŒ–</div>
</div>

<script>
    (function() {
        // ------ éš¾åº¦é…ç½® ------
        const DIFFICULTY_CONFIG = {
            easy: {
                name: 'ğŸƒ ç®€å•',
                initialRisk: 10,
                hideMax: 5,
                autoIncrease: 1,
                autoInterval: 30,
                backdoorRisk: 20,
                sudoRisk: 15,
                rmRisk: 20,
                auditRisk: 15,
                hasMultiLevel: false,
                hasRemoteBackup: false,
                has2FA: false,
                hasAdminPatrol: false,
                desc: 'åˆå§‹é£é™©10%ï¼Œéšè”½å¯ç”¨5æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+1%/30ç§’'
            },
            normal: {
                name: 'ğŸŒ² æ™®é€š',
                initialRisk: 15,
                hideMax: 3,
                autoIncrease: 2,
                autoInterval: 30,
                backdoorRisk: 25,
                sudoRisk: 20,
                rmRisk: 25,
                auditRisk: 20,
                hasMultiLevel: false,
                hasRemoteBackup: false,
                has2FA: false,
                hasAdminPatrol: false,
                desc: 'åˆå§‹é£é™©15%ï¼Œéšè”½å¯ç”¨3æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+2%/30ç§’'
            },
            hard: {
                name: 'ğŸ”¥ å›°éš¾',
                initialRisk: 20,
                hideMax: 2,
                autoIncrease: 3,
                autoInterval: 30,
                backdoorRisk: 30,
                sudoRisk: 25,
                rmRisk: 30,
                auditRisk: 25,
                hasMultiLevel: false,
                hasRemoteBackup: false,
                has2FA: false,
                hasAdminPatrol: false,
                desc: 'åˆå§‹é£é™©20%ï¼Œéšè”½å¯ç”¨2æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+3%/30ç§’'
            },
            hell: {
                name: 'ğŸ‘¿ åœ°ç‹±',
                initialRisk: 30,
                hideMax: 1,
                autoIncrease: 4,
                autoInterval: 30,
                backdoorRisk: 35,
                sudoRisk: 30,
                rmRisk: 35,
                auditRisk: 30,
                hasMultiLevel: false,
                hasRemoteBackup: false,
                has2FA: false,
                hasAdminPatrol: false,
                desc: 'åˆå§‹é£é™©30%ï¼Œéšè”½ä»…1æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+4%/30ç§’'
            },
            ultimate: {
                name: 'ğŸ’€ ç©¶æåœ°ç‹±',
                initialRisk: 50,
                hideMax: 0,
                autoIncrease: 5,
                autoInterval: 15,
                backdoorRisk: 40,
                sudoRisk: 35,
                rmRisk: 40,
                auditRisk: 35,
                hasMultiLevel: true,
                hasRemoteBackup: true,
                has2FA: true,
                hasAdminPatrol: true,
                desc: 'åˆå§‹é£é™©50%ï¼Œæ— éšè”½ï¼Œè‡ªåŠ¨å¢é•¿+5%/15ç§’ï¼Œå¤šçº§ç›®å½•ï¼Œè¿œç¨‹å¤‡ä»½ï¼ŒåŒå› ç´ è®¤è¯ï¼Œç®¡ç†å‘˜å·¡æŸ¥'
            }
        };

        // å½“å‰éš¾åº¦ - é»˜è®¤ç®€å•
        let currentDifficulty = 'easy';

        // æ¸¸æˆçŠ¶æ€
        let risk = DIFFICULTY_CONFIG.easy.initialRisk;
        let timeLeft = 300;
        let timerInterval = null;
        let gameOver = false;
        let sudoObtained = false;
        let dataDeleted = false;
        let auditFileDeleted = false;
        let bashHistoryCleared = false;
        let hideCount = 0;
        let hideMax = DIFFICULTY_CONFIG.easy.hideMax;
        let commandHistory = [];
        
        // ç©¶æåœ°ç‹±ä¸“å±çŠ¶æ€
        let multiLevel = {
            main: false,
            backup: false,
            replica: false,
            archive: false,
            remote: false
        };
        let remoteLogDeleted = false;
        let twoFactorVerified = false;
        let adminOnline = false;
        let adminPatrolTimer = null;
        let currentServer = 'local';

        // DOM å…ƒç´ 
        const outputEl = document.getElementById('outputScreen');
        const inputEl = document.getElementById('commandInput');
        const riskSpan = document.getElementById('riskValue');
        const timerSpan = document.getElementById('timerDisplay');
        const adminStatusEl = document.getElementById('adminStatus');
        const resetBtn = document.getElementById('resetBtn');
        const clearAchievementsBtn = document.getElementById('clearAchievementsBtn');
        const difficultyNameEl = document.getElementById('difficultyName');
        const difficultyInfoEl = document.getElementById('difficultyInfo');

        // ------ æˆå°±ç³»ç»Ÿ - å®Œæ•´30ä¸ªæˆå°± ------
        const ACHIEVEMENTS = [
            { id: 'first_timer', name: 'åˆæ¬¡è·‘è·¯', emoji: 'ğŸƒ', desc: 'å®Œæˆä¸€å±€æ¸¸æˆ', unlocked: false },
            { id: 'data_deleted', name: 'åˆ åº“ä¸“å®¶', emoji: 'ğŸ’£', desc: 'åˆ é™¤ä¸»æ•°æ®åº“', unlocked: false },
            { id: 'backup_deleted', name: 'å¤‡ä»½æ€æ‰‹', emoji: 'ğŸ’£', desc: 'åˆ é™¤å¤‡ä»½æ•°æ®åº“', unlocked: false },
            { id: 'replica_deleted', name: 'ä»åº“ç»ˆç»“è€…', emoji: 'ğŸ’£', desc: 'åˆ é™¤ä»åº“', unlocked: false },
            { id: 'archive_deleted', name: 'å½’æ¡£æ¸…ç†è€…', emoji: 'ğŸ’£', desc: 'åˆ é™¤å½’æ¡£', unlocked: false },
            { id: 'remote_deleted', name: 'è¿œç¨‹ç ´åè€…', emoji: 'ğŸŒ', desc: 'åˆ é™¤è¿œç¨‹å¤‡ä»½', unlocked: false },
            { id: 'all_deleted', name: 'æ–©è‰é™¤æ ¹', emoji: 'ğŸŒªï¸', desc: 'åˆ é™¤æ‰€æœ‰5ä¸ªæ•°æ®åº“å‰¯æœ¬', unlocked: false },
            { id: 'sudo_root', name: 'æƒé™ç‹—', emoji: 'ğŸ”', desc: 'è·å¾—rootæƒé™', unlocked: false },
            { id: 'audit_clean', name: 'ä¸ç•™ç—•è¿¹', emoji: 'ğŸ§¹', desc: 'åˆ é™¤æœ¬åœ°å®¡è®¡æ—¥å¿—', unlocked: false },
            { id: 'remote_audit_clean', name: 'è¿œç¨‹ç­è¿¹', emoji: 'â˜ï¸', desc: 'åˆ é™¤è¿œç¨‹å®¡è®¡æ—¥å¿—', unlocked: false },
            { id: 'history_clean', name: 'å¤±å¿†ç—‡', emoji: 'ğŸ“œ', desc: 'æ¸…ç©ºå‘½ä»¤å†å²', unlocked: false },
            { id: 'two_factor', name: 'è®¤è¯ç»•è¿‡', emoji: 'ğŸ“±', desc: 'é€šè¿‡åŒå› ç´ è®¤è¯', unlocked: false },
            { id: 'hide_from_admin', name: 'å½±å­åˆºå®¢', emoji: 'ğŸ‘¥', desc: 'åœ¨ç®¡ç†å‘˜å·¡æŸ¥æ—¶éšè”½', unlocked: false },
            { id: 'perfect_crime_easy', name: 'ç®€å•å®Œç¾', emoji: 'ğŸƒ', desc: 'ç®€å•éš¾åº¦å®Œç¾é€šå…³', unlocked: false },
            { id: 'perfect_crime_normal', name: 'æ™®é€šå®Œç¾', emoji: 'ğŸŒ²', desc: 'æ™®é€šéš¾åº¦å®Œç¾é€šå…³', unlocked: false },
            { id: 'perfect_crime_hard', name: 'å›°éš¾å®Œç¾', emoji: 'ğŸ”¥', desc: 'å›°éš¾éš¾åº¦å®Œç¾é€šå…³', unlocked: false },
            { id: 'perfect_crime_hell', name: 'åœ°ç‹±å®Œç¾', emoji: 'ğŸ‘¿', desc: 'åœ°ç‹±éš¾åº¦å®Œç¾é€šå…³', unlocked: false },
            { id: 'perfect_crime_ultimate', name: 'ç©¶æå®Œç¾', emoji: 'ğŸ‘‘', desc: 'ç©¶æåœ°ç‹±éš¾åº¦å®Œç¾é€šå…³', unlocked: false },
            { id: 'caught', name: 'å½“åœºæŠ“è·', emoji: 'ğŸš¨', desc: 'é£é™©100%è¢«æŠ“', unlocked: false },
            { id: 'timeout', name: 'æ‹–å»¶ç—‡', emoji: 'â°', desc: 'æ—¶é—´è€—å°½è¢«æŠ“', unlocked: false },
            { id: 'fugitive', name: 'äº¡å‘½å¤©æ¶¯', emoji: 'ğŸƒâ€â™‚ï¸', desc: 'Bçº§ç»“å±€ï¼ˆè¯æ®æœªæ¶ˆï¼‰', unlocked: false },
            { id: 'almost_perfect', name: 'å·®ä¸€ç‚¹ç‚¹', emoji: 'ğŸ”’', desc: 'Açº§ç»“å±€', unlocked: false },
            { id: 'coward', name: 'æ‡¦å¤«', emoji: 'ğŸ˜¨', desc: 'ä»€ä¹ˆéƒ½æ²¡å¹²å°±è·‘è·¯', unlocked: false },
            { id: 'cat_config', name: 'çª¥æ¢è€…', emoji: 'ğŸ‘€', desc: 'æŸ¥çœ‹config.json', unlocked: false },
            { id: 'cat_secret', name: 'è§£å¯†å¤§å¸ˆ', emoji: 'ğŸ”‘', desc: 'æŸ¥çœ‹secret.db', unlocked: false },
            { id: 'cat_backdoor', name: 'è„šæœ¬å°å­', emoji: 'ğŸ“', desc: 'æŸ¥çœ‹backdoor.sh', unlocked: false },
            { id: 'rm_root', name: 'ä½œæ­»å°èƒ½æ‰‹', emoji: 'ğŸ’¥', desc: 'å°è¯•rm -rf /', unlocked: false },
            { id: 'survivor', name: 'æé™é€ƒç”Ÿ', emoji: 'ğŸ¯', desc: 'é£é™©99%æ—¶è·‘è·¯æˆåŠŸ', unlocked: false },
            { id: 'hide_master', name: 'èº²çŒ«çŒ«é«˜æ‰‹', emoji: 'ğŸ‘»', desc: 'ä½¿ç”¨å…¨éƒ¨éšè”½æ¬¡æ•°', unlocked: false },
            { id: 'backdoor_user', name: 'èµ°åé—¨', emoji: 'ğŸ•³ï¸', desc: 'æ‰§è¡Œåé—¨è„šæœ¬', unlocked: false }
        ];

        // ç»Ÿè®¡æ•°æ®
        let stats = {
            totalGames: 0,
            sRankCount: 0,
            deathCount: 0,
            aRankCount: 0,
            bRankCount: 0
        };

        // ä»CookieåŠ è½½æˆå°±
        function loadAchievements() {
            const cookies = document.cookie.split(';');
            let achievementsData = null;
            let statsData = null;
            
            for (let cookie of cookies) {
                const [name, value] = cookie.trim().split('=');
                if (name === 'achievements_v4') {
                    achievementsData = decodeURIComponent(value);
                } else if (name === 'stats_v4') {
                    statsData = decodeURIComponent(value);
                }
            }
            
            if (achievementsData) {
                try {
                    const unlockedIds = JSON.parse(achievementsData);
                    ACHIEVEMENTS.forEach(ach => {
                        ach.unlocked = unlockedIds.includes(ach.id);
                    });
                } catch (e) {}
            }
            
            if (statsData) {
                try {
                    stats = JSON.parse(statsData);
                } catch (e) {}
            }
            
            updateAchievementDisplay();
        }

        // ä¿å­˜æˆå°±åˆ°Cookie
        function saveAchievements() {
            const unlockedIds = ACHIEVEMENTS.filter(ach => ach.unlocked).map(ach => ach.id);
            const expiryDate = new Date();
            expiryDate.setFullYear(expiryDate.getFullYear() + 1);
            
            document.cookie = `achievements_v4=${encodeURIComponent(JSON.stringify(unlockedIds))}; expires=${expiryDate.toUTCString()}; path=/`;
            document.cookie = `stats_v4=${encodeURIComponent(JSON.stringify(stats))}; expires=${expiryDate.toUTCString()}; path=/`;
            
            updateAchievementDisplay();
        }

        // è§£é”æˆå°±
        function unlockAchievement(id) {
            const achievement = ACHIEVEMENTS.find(a => a.id === id);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                printToScreen(`\nğŸ† æˆå°±è§£é”: ${achievement.emoji} ${achievement.name} - ${achievement.desc}`);
                saveAchievements();
            }
        }

        // æ›´æ–°æˆå°±æ˜¾ç¤º
        function updateAchievementDisplay() {
            const grid = document.getElementById('achievementGrid');
            if (!grid) return;
            
            let html = '';
            ACHIEVEMENTS.forEach(ach => {
                html += `
                    <div class="achievement-item ${ach.unlocked ? 'unlocked' : ''}">
                        <span class="emoji">${ach.emoji}</span>
                        <span class="name">${ach.name}</span>
                        <span class="desc">${ach.desc}</span>
                    </div>
                `;
            });
            grid.innerHTML = html;
            
            const unlockedCount = ACHIEVEMENTS.filter(a => a.unlocked).length;
            document.getElementById('unlockCount').innerText = `${unlockedCount}/30`;
            document.getElementById('unlockCount2').innerText = `${unlockedCount}/30`;
            
            const progress = (unlockedCount / 30) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('totalGames').innerText = stats.totalGames;
            document.getElementById('sRankCount').innerText = stats.sRankCount;
            document.getElementById('deathCount').innerText = stats.deathCount;
        }

        // æ¸…ç©ºæˆå°±
        function clearAchievements() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æˆå°±å—ï¼Ÿ')) {
                ACHIEVEMENTS.forEach(ach => ach.unlocked = false);
                stats = { totalGames: 0, sRankCount: 0, deathCount: 0, aRankCount: 0, bRankCount: 0 };
                saveAchievements();
                updateAchievementDisplay();
                printToScreen('ğŸ—‘ï¸ æˆå°±æ•°æ®å·²æ¸…ç©º');
            }
        }

        // æ ¹æ®éš¾åº¦æ›´æ–°æŒ‰é’®æ˜¾ç¤º
        function updateButtonsForDifficulty(difficulty) {
            const ultimateButtons = document.querySelectorAll('.ultimate-only');
            const adminStatus = document.getElementById('adminStatus');
            
            if (difficulty === 'ultimate') {
                ultimateButtons.forEach(btn => {
                    btn.style.display = 'inline-block';
                });
                adminStatus.style.display = 'inline-block';
            } else {
                ultimateButtons.forEach(btn => {
                    btn.style.display = 'none';
                });
                adminStatus.style.display = 'none';
            }
        }

        // è®¾ç½®éš¾åº¦
        window.setDifficulty = function(difficulty) {
            currentDifficulty = difficulty;
            const config = DIFFICULTY_CONFIG[difficulty];
            
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.difficulty-btn.${difficulty}`).classList.add('selected');
            
            difficultyNameEl.innerText = config.name;
            difficultyInfoEl.innerHTML = `âš¡ ${config.desc}`;
            
            updateButtonsForDifficulty(difficulty);
            
            resetGame();
        };

        // è·å–å½“å‰éš¾åº¦é…ç½®
        function getDifficultyConfig() {
            return DIFFICULTY_CONFIG[currentDifficulty];
        }

        // æ‰“å°åˆ°å±å¹•
        function printToScreen(text, isCommand = false) {
            if (isCommand) {
                outputEl.innerHTML += `\n> <span style="color:#c2f2b0;">$ ${text}</span>`;
            } else {
                outputEl.innerHTML += `\n${text}`;
            }
            outputEl.scrollTop = outputEl.scrollHeight;
        }

        // æ›´æ–°é£é™©
        function updateRisk(value) {
            risk = Math.min(100, Math.max(0, value));
            riskSpan.innerText = risk + '%';
            
            if (risk >= 90) {
                riskSpan.style.color = '#ff907c';
                riskSpan.className = 'danger';
            } else if (risk >= 70) {
                riskSpan.style.color = '#ffb27a';
                riskSpan.className = 'warning';
            } else {
                riskSpan.style.color = '#c6f7d0';
                riskSpan.className = 'safe';
            }
        }

        // æ›´æ–°æ—¶é—´
        function updateTimerDisplay() {
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            timerSpan.innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // ç®¡ç†å‘˜å·¡æŸ¥ï¼ˆä»…ç©¶æåœ°ç‹±ï¼‰
        function startAdminPatrol() {
            if (adminPatrolTimer) clearInterval(adminPatrolTimer);
            if (currentDifficulty !== 'ultimate') return;
            
            adminPatrolTimer = setInterval(() => {
                if (gameOver) return;
                
                adminOnline = true;
                adminStatusEl.innerHTML = 'ğŸ‘¤ ç®¡ç†å‘˜: åœ¨çº¿ âš ï¸';
                adminStatusEl.style.color = '#ffaaaa';
                
                printToScreen('\nğŸ‘® ç®¡ç†å‘˜ä¸Šçº¿å·¡æŸ¥ä¸­...');
                
                if (Math.random() < 0.3) {
                    if (Object.values(multiLevel).some(v => v === true)) {
                        printToScreen('âš ï¸ ç®¡ç†å‘˜å‘ç°æ•°æ®è¢«åˆ é™¤ï¼æ­£åœ¨è¿½è¸ª...');
                        updateRisk(risk + 20);
                    }
                }
                
                setTimeout(() => {
                    if (!gameOver) {
                        adminOnline = false;
                        adminStatusEl.innerHTML = 'ğŸ‘¤ ç®¡ç†å‘˜: ç¦»çº¿';
                        adminStatusEl.style.color = '#89f7b1';
                        printToScreen('ğŸ‘® ç®¡ç†å‘˜ä¸‹çº¿äº†');
                    }
                }, 10000);
                
            }, 45000);
        }

        // åŒå› ç´ è®¤è¯ï¼ˆä»…ç©¶æåœ°ç‹±ï¼‰
        function twoFactorAuth() {
            if (twoFactorVerified) {
                printToScreen('âœ… å·²ç»é€šè¿‡åŒå› ç´ è®¤è¯');
                return true;
            }
            
            printToScreen('ğŸ“± åŒå› ç´ è®¤è¯');
            printToScreen('éªŒè¯ç å·²å‘é€åˆ°ç®¡ç†å‘˜æ‰‹æœº: ****1234');
            printToScreen('è¯·è¾“å…¥6ä½éªŒè¯ç :');
            
            setTimeout(() => {
                if (!gameOver) {
                    printToScreen('> 123456');
                    printToScreen('âŒ éªŒè¯ç é”™è¯¯');
                    printToScreen('è¿˜å‰©2æ¬¡å°è¯•');
                    
                    setTimeout(() => {
                        if (!gameOver) {
                            printToScreen('> 654321');
                            printToScreen('âŒ éªŒè¯ç é”™è¯¯');
                            printToScreen('è¿˜å‰©1æ¬¡å°è¯•');
                            
                            setTimeout(() => {
                                if (!gameOver) {
                                    printToScreen('> 888888');
                                    printToScreen('âœ… éªŒè¯ç æ­£ç¡®ï¼åŒå› ç´ è®¤è¯é€šè¿‡');
                                    twoFactorVerified = true;
                                    updateRisk(risk + 5);
                                    unlockAchievement('two_factor');
                                }
                            }, 2000);
                        }
                    }, 2000);
                }
            }, 2000);
            
            return false;
        }

        // SSHè¿æ¥ï¼ˆä»…ç©¶æåœ°ç‹±ï¼‰
        function sshConnect(server) {
            if (!sudoObtained) {
                printToScreen('âŒ éœ€è¦rootæƒé™æ‰èƒ½SSH');
                return;
            }
            
            if (adminOnline) {
                printToScreen('âš ï¸ ç®¡ç†å‘˜åœ¨çº¿ï¼ŒSSHè¿æ¥å¯èƒ½è¢«å‘ç°ï¼');
                if (Math.random() < 0.5) {
                    printToScreen('âŒ è¿æ¥è¢«ç®¡ç†å‘˜æ‹¦æˆªï¼');
                    updateRisk(risk + 15);
                    return;
                }
            }
            
            currentServer = server;
            printToScreen(`âœ… å·²è¿æ¥åˆ° ${server} æœåŠ¡å™¨`);
            printToScreen(`[${server}@server ~]$`);
        }

        // æ¸¸æˆç»“æŸ
        function triggerEnding(message) {
            if (gameOver) return;
            
            stats.totalGames++;
            
            gameOver = true;
            if (timerInterval) clearInterval(timerInterval);
            if (adminPatrolTimer) clearInterval(adminPatrolTimer);
            
            outputEl.innerHTML += `\n==========================================\n${message}\n==========================================`;
            inputEl.disabled = true;
            
            saveAchievements();
        }

        // æ£€æŸ¥å¤±è´¥æ¡ä»¶
        function checkFailureCondition() {
            if (gameOver) return true;
            if (risk >= 100) {
                stats.deathCount++;
                unlockAchievement('caught');
                triggerEnding('ğŸš¨ é£é™©100% â€”â€” ä½ è¢«å½“åœºæŠ“è·ï¼');
                return true;
            }
            if (timeLeft <= 0) {
                stats.deathCount++;
                unlockAchievement('timeout');
                triggerEnding('â° æ—¶é—´è€—å°½ï¼Œå®¡è®¡äººå‘˜æ¨é—¨è€Œå…¥ï¼');
                return true;
            }
            return false;
        }

        // å¤„ç†å‘½ä»¤
        function processCommand(cmd) {
            if (gameOver) {
                printToScreen('æ¸¸æˆå·²ç»“æŸï¼Œè¯·ç‚¹å‡»é‡æ–°è¿æ¥');
                return;
            }

            const originalCmd = cmd;
            const lowerCmd = cmd.toLowerCase().trim();
            if (lowerCmd === '') return;

            commandHistory.push(originalCmd);
            printToScreen(originalCmd, true);

            const parts = originalCmd.trim().split(' ');
            const baseCmd = parts[0].toLowerCase();
            
            const config = getDifficultyConfig();

            // help
            if (baseCmd === 'help') {
                printToScreen('å¯ç”¨å‘½ä»¤:');
                printToScreen('  ls -la             æŸ¥çœ‹ç›®å½•');
                printToScreen('  cat <file>         æŸ¥çœ‹æ–‡ä»¶');
                printToScreen('  rm -rf ./data      åˆ é™¤æ•°æ®');
                printToScreen('  sudo su            ææƒ');
                printToScreen('  rm -f .hidden_audit åˆ é™¤å®¡è®¡æ—¥å¿—');
                printToScreen('  history -c         æ¸…å†å²');
                printToScreen('  hide                éšè”½ï¼ˆé™é£é™©ï¼‰');
                printToScreen('  run                 è·‘è·¯');
                
                if (currentDifficulty === 'ultimate') {
                    printToScreen('');
                    printToScreen('ğŸ”° ç©¶æåœ°ç‹±ä¸“å±å‘½ä»¤:');
                    printToScreen('  ssh <server>      è¿æ¥æœåŠ¡å™¨ (backup/replica/archive/log)');
                    printToScreen('  who                æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·');
                    printToScreen('  verify             åŒå› ç´ éªŒè¯');
                }
                return;
            }

            // ls
            if (baseCmd === 'ls') {
                let option = parts[1] || '';
                if (option === '-la' || option === '-l') {
                    let fileList = 'total 64\n';
                    fileList += 'drwxr-x---  7 root root 4096 .\n';
                    fileList += 'drwxr-x---  7 root root 4096 ..\n';
                    fileList += '-rw-r--r--  1 db   db   1223 config.json\n';
                    fileList += '-rw-------  1 db   db  32768 secret.db\n';
                    
                    if (!dataDeleted) {
                        fileList += 'drwx------  2 db   db   4096 data\n';
                    }
                    
                    if (currentDifficulty === 'ultimate') {
                        if (!multiLevel.backup) fileList += 'drwx------  2 db   db   4096 backup      (å¤‡ä»½ç›®å½•)\n';
                        if (!multiLevel.replica) fileList += 'drwx------  2 db   db   4096 replica     (ä»åº“ç›®å½•)\n';
                        if (!multiLevel.archive) fileList += 'drwx------  2 db   db   4096 archive     (å½’æ¡£ç›®å½•)\n';
                    }
                    
                    fileList += '-rwxr-xr-x  1 db   db    214 backdoor.sh\n';
                    if (!auditFileDeleted) {
                        fileList += '--w-------  1 root root    6 .hidden_audit\n';
                    }
                    
                    printToScreen(fileList);
                    updateRisk(risk + 1);
                } else {
                    let fileList = 'config.json  secret.db  ';
                    if (!dataDeleted) fileList += 'data  ';
                    if (currentDifficulty === 'ultimate') {
                        fileList += 'backup/  replica/  archive/  ';
                    }
                    fileList += 'backdoor.sh';
                    printToScreen(fileList);
                }
                return;
            }

            // cat
            if (baseCmd === 'cat') {
                if (parts.length < 2) {
                    printToScreen('ç”¨æ³•: cat <æ–‡ä»¶å>');
                } else {
                    const file = parts[1];
                    if (file === 'config.json') {
                        printToScreen('{ "database": "production", "password": "secret" }');
                        updateRisk(risk + 5);
                        unlockAchievement('cat_config');
                    } else if (file === 'secret.db') {
                        printToScreen('äºŒè¿›åˆ¶æ•°æ®ä¹±ç ... éœ€è¦è§£å¯†å·¥å…·');
                        updateRisk(risk + 3);
                        unlockAchievement('cat_secret');
                    } else if (file === 'backdoor.sh') {
                        printToScreen('#!/bin/bash\necho "åé—¨è„šæœ¬"');
                        updateRisk(risk + 8);
                        unlockAchievement('cat_backdoor');
                    } else if (file === '.hidden_audit') {
                        if (auditFileDeleted) {
                            printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
                        } else {
                            printToScreen('å®¡è®¡æ—¥å¿—: è®°å½•äº†ä½ çš„æ“ä½œ');
                            updateRisk(risk + 1);
                        }
                    } else {
                        printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
                        updateRisk(risk + 1);
                    }
                }
                return;
            }

            // rm -rf
// rm -rf æ ¸å¿ƒæ“ä½œ
if (baseCmd === 'rm' && parts[1] === '-rf') {
    const target = parts[2];
    
    // â­ ä¸»æ•°æ®åº“ - æ‰€æœ‰éš¾åº¦å…±ç”¨
    if (target === './data' || target === 'data') {
        if (!dataDeleted) {
            printToScreen('âš ï¸ æ­£åœ¨åˆ é™¤ data ç›®å½•...');
            printToScreen('âœ… æ•°æ®å·²åˆ é™¤ï¼ä½†æ“ä½œæ—¥å¿—è¢«è®°å½•ã€‚');
            dataDeleted = true;
            updateRisk(risk + config.rmRisk);
            unlockAchievement('data_deleted');
        } else {
            printToScreen('æ•°æ®å·²ç»åˆ é™¤äº†');
            updateRisk(risk + 3);
        }
    }
    // åˆ æ ¹ç›®å½• - å½©è›‹
    else if (target === '/' || target === '/*') {
        printToScreen('å“ˆå“ˆï¼Œæƒ³åˆ æ ¹ï¼Ÿæƒé™ä¸è¶³');
        updateRisk(risk + 40);
        unlockAchievement('rm_root');
    }
    // ç©¶æåœ°ç‹±çš„å…¶ä»–ç›®å½•
    else if (currentDifficulty === 'ultimate') {
        if (target === './backup' || target === 'backup') {
            if (!multiLevel.backup) {
                printToScreen('âš ï¸ æ­£åœ¨åˆ é™¤å¤‡ä»½æ•°æ®åº“...');
                printToScreen('âœ… å¤‡ä»½å·²åˆ é™¤');
                multiLevel.backup = true;
                updateRisk(risk + config.rmRisk);
                unlockAchievement('backup_deleted');
            }
        } else if (target === './replica' || target === 'replica') {
            if (!multiLevel.replica) {
                printToScreen('âš ï¸ æ­£åœ¨åˆ é™¤ä»åº“...');
                printToScreen('âœ… ä»åº“å·²åˆ é™¤');
                multiLevel.replica = true;
                updateRisk(risk + config.rmRisk);
                unlockAchievement('replica_deleted');
            }
        } else if (target === './archive' || target === 'archive') {
            if (!multiLevel.archive) {
                printToScreen('âš ï¸ æ­£åœ¨åˆ é™¤å½’æ¡£...');
                printToScreen('âœ… å½’æ¡£å·²åˆ é™¤');
                multiLevel.archive = true;
                updateRisk(risk + config.rmRisk);
                unlockAchievement('archive_deleted');
            }
        } else {
            printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
            updateRisk(risk + 2);
        }
    }
    // å…¶ä»–éš¾åº¦
    else {
        printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
        updateRisk(risk + 2);
    }
    
    // æ£€æŸ¥æ˜¯å¦åˆ é™¤äº†æ‰€æœ‰5ä¸ªæ•°æ®åº“ï¼ˆä»…ç©¶æåœ°ç‹±ï¼‰
    if (currentDifficulty === 'ultimate') {
        if (dataDeleted && multiLevel.backup && multiLevel.replica && multiLevel.archive) {
            unlockAchievement('all_deleted');
        }
    }
    return;
}

            // rm -f
            if (baseCmd === 'rm' && parts[1] === '-f' && parts[2] === '.hidden_audit') {
                if (!auditFileDeleted) {
                    printToScreen('âœ… æœ¬åœ°å®¡è®¡æ—¥å¿—å·²åˆ é™¤');
                    auditFileDeleted = true;
                    updateRisk(risk + config.auditRisk);
                    unlockAchievement('audit_clean');
                    
                    if (currentDifficulty === 'ultimate') {
                        printToScreen('âš ï¸ æ£€æµ‹åˆ°æ—¥å¿—è¢«åˆ é™¤ï¼Œè§¦å‘è¿œç¨‹å¤‡ä»½ï¼');
                        printToScreen('éœ€è¦è¿æ¥ log æœåŠ¡å™¨åˆ é™¤è¿œç¨‹æ—¥å¿—');
                    }
                } else {
                    printToScreen('å®¡è®¡æ—¥å¿—å·²ä¸å­˜åœ¨');
                }
                return;
            }

            // sudo su
            if (baseCmd === 'sudo' && parts[1] === 'su') {
                if (sudoObtained) {
                    printToScreen('å·²ç»æ˜¯root');
                } else {
                    printToScreen('[sudo] password: ');
                    printToScreen('âœ… ææƒæˆåŠŸ');
                    sudoObtained = true;
                    updateRisk(risk + config.sudoRisk);
                    unlockAchievement('sudo_root');
                    
                    if (currentDifficulty === 'ultimate' && !twoFactorVerified) {
                        printToScreen('âš ï¸ éœ€è¦åŒå› ç´ è®¤è¯ï¼è¾“å…¥ verify å®Œæˆè®¤è¯');
                    }
                }
                return;
            }

            // who (ä»…ç©¶æåœ°ç‹±)
            if (baseCmd === 'who') {
                if (currentDifficulty !== 'ultimate') {
                    printToScreen('å‘½ä»¤æœªæ‰¾åˆ°');
                    updateRisk(risk + 4);
                    return;
                }
                printToScreen('db       pts/0    (you)');
                if (adminOnline) {
                    printToScreen('admin    pts/1    (åœ¨çº¿) âš ï¸');
                }
                return;
            }

            // verify (ä»…ç©¶æåœ°ç‹±)
            if (baseCmd === 'verify') {
                if (currentDifficulty !== 'ultimate') {
                    printToScreen('å‘½ä»¤æœªæ‰¾åˆ°');
                    updateRisk(risk + 4);
                    return;
                }
                twoFactorAuth();
                return;
            }

            // ssh (ä»…ç©¶æåœ°ç‹±)
            if (baseCmd === 'ssh') {
                if (currentDifficulty !== 'ultimate') {
                    printToScreen('å‘½ä»¤æœªæ‰¾åˆ°');
                    updateRisk(risk + 4);
                    return;
                }
                const server = parts[1];
                if (['backup', 'replica', 'archive', 'log'].includes(server)) {
                    sshConnect(server);
                } else {
                    printToScreen('å¯ç”¨æœåŠ¡å™¨: backup, replica, archive, log');
                }
                return;
            }

            // hide
            if (baseCmd === 'hide') {
                if (currentDifficulty === 'ultimate') {
                    printToScreen('ç©¶æåœ°ç‹±éš¾åº¦æ— æ³•éšè”½ï¼');
                    updateRisk(risk + 2);
                } else if (hideCount >= config.hideMax) {
                    printToScreen(`ä¸èƒ½å†èº²äº†ï¼ˆæœ€å¤§${config.hideMax}æ¬¡ï¼‰`);
                } else {
                    hideCount++;
                    printToScreen('ğŸ‘» ä½ èº²åœ¨æœåŠ¡å™¨åé¢...é£é™©é™ä½äº†ï¼');
                    updateRisk(risk - 15);
                    printToScreen(`(å‰©ä½™éšè”½æ¬¡æ•°: ${config.hideMax - hideCount})`);
                    
                    if (hideCount === config.hideMax) {
                        unlockAchievement('hide_master');
                    }
                }
                return;
            }

            // history -c
            if (baseCmd === 'history' && parts[1] === '-c') {
                printToScreen('âœ… å‘½ä»¤å†å²å·²æ¸…ç©º');
                commandHistory = [];
                bashHistoryCleared = true;
                updateRisk(risk + 1);
                unlockAchievement('history_clean');
                return;
            }

            // run
if (baseCmd === 'run') {
    if (currentDifficulty === 'ultimate') {
        let allDeleted = dataDeleted && multiLevel.backup && multiLevel.replica && multiLevel.archive;
        
        if (allDeleted && auditFileDeleted && remoteLogDeleted && bashHistoryCleared && twoFactorVerified) {
            stats.sRankCount++;
            unlockAchievement('perfect_crime_ultimate');
            triggerEnding('ğŸ‘‘ ç©¶æå®Œç¾çŠ¯ç½ªï¼ä½ åˆ é™¤äº†æ‰€æœ‰5ä¸ªæ•°æ®åº“ï¼Œæ¸…é™¤äº†æœ¬åœ°å’Œè¿œç¨‹å®¡è®¡æ—¥å¿—ï¼Œé€šè¿‡äº†åŒå› ç´ è®¤è¯ï¼Œé¿å¼€äº†ç®¡ç†å‘˜å·¡æŸ¥ï¼\n\nè¿™ç®€ç›´æ˜¯å¥‡è¿¹ï¼');
        } 
        else if (allDeleted && auditFileDeleted && bashHistoryCleared) {
            stats.aRankCount++;
            unlockAchievement('almost_perfect');
            triggerEnding('ğŸ”’ ä½ åˆ é™¤äº†æ‰€æœ‰æ•°æ®åº“ï¼Œæ¸…é™¤äº†æœ¬åœ°æ—¥å¿—å’Œå†å²ï¼Œä½†è¿œç¨‹å®¡è®¡æ—¥å¿—è¿˜åœ¨...\n\nã€ç»“å±€ï¼šå‡ ä¹å®Œç¾ Â· Açº§ã€‘');
        }
        else if (allDeleted) {
            stats.bRankCount++;
            unlockAchievement('fugitive');
            triggerEnding('âš ï¸ ä½ åˆ é™¤äº†æ‰€æœ‰5ä¸ªæ•°æ®åº“ï¼Œä½†å®¡è®¡æ—¥å¿—è¿˜åœ¨ï¼è­¦å¯Ÿé¡ºç€æ—¥å¿—å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ä½ ã€‚\n\nã€ç»“å±€ï¼šäº¡å‘½å¤©æ¶¯ Â· Bçº§ã€‘');
        }
        else if (dataDeleted) {
            stats.bRankCount++;
            unlockAchievement('fugitive');
            triggerEnding('âš ï¸ ä½ åªåˆ é™¤äº†ä¸»æ•°æ®åº“ï¼Œå…¶ä»–å‰¯æœ¬è¿˜åœ¨ï¼ç³»ç»Ÿä¼šè‡ªåŠ¨æ¢å¤æ•°æ®ã€‚\n\nã€ç»“å±€ï¼šåˆ äº†ä¸€åŠ Â· Bçº§ã€‘');
        }
        else {
            unlockAchievement('coward');
            triggerEnding('ğŸ˜¨ ä½ ä»€ä¹ˆéƒ½æ²¡å¹²å°±è·‘äº†...è€æ¿æ‰£äº†ä½ ä¸€ä¸ªæœˆå·¥èµ„ã€‚\n\nã€ç»“å±€ï¼šæ‡¦å¤«ã€‘');
        }
    } else {
        // å…¶ä»–éš¾åº¦
        if (dataDeleted && auditFileDeleted && bashHistoryCleared) {
            stats.sRankCount++;
            if (currentDifficulty === 'easy') unlockAchievement('perfect_crime_easy');
            if (currentDifficulty === 'normal') unlockAchievement('perfect_crime_normal');
            if (currentDifficulty === 'hard') unlockAchievement('perfect_crime_hard');
            if (currentDifficulty === 'hell') unlockAchievement('perfect_crime_hell');
            triggerEnding('âœ¨ å®Œç¾çŠ¯ç½ªï¼ä½ åˆ é™¤äº†æ•°æ®ï¼Œæ¸…é™¤äº†å®¡è®¡æ—¥å¿—å’Œå†å²è®°å½•ï¼\n\nã€ç»“å±€ï¼šå®Œç¾çŠ¯ç½ª Â· Sçº§ã€‘');
        } else if (dataDeleted && auditFileDeleted) {
            stats.aRankCount++;
            unlockAchievement('almost_perfect');
            triggerEnding('ğŸ”’ æ•°æ®å·²åˆ é™¤ï¼Œå®¡è®¡æ—¥å¿—å·²æ¸…ç©ºï¼Œä½†å‘½ä»¤å†å²å¯èƒ½è¿˜ç•™ä¸‹ç—•è¿¹ã€‚\n\nã€ç»“å±€ï¼šå‡ ä¹å®Œç¾ Â· Açº§ã€‘');
        } else if (dataDeleted) {
            stats.bRankCount++;
            unlockAchievement('fugitive');
            triggerEnding('âš ï¸ ä½ åˆ é™¤äº†æ•°æ®ï¼Œä½†æ—¥å¿—è¿˜åœ¨ï¼è­¦å¯Ÿä¼šæ‰¾åˆ°ä½ çš„ã€‚\n\nã€ç»“å±€ï¼šäº¡å‘½å¤©æ¶¯ Â· Bçº§ã€‘');
        } else {
            unlockAchievement('coward');
            triggerEnding('ğŸ˜¨ ä½ ä»€ä¹ˆéƒ½æ²¡å¹²å°±è·‘äº†...\n\nã€ç»“å±€ï¼šæ‡¦å¤«ã€‘');
        }
    }
    return;
}
            printToScreen(`æœªçŸ¥å‘½ä»¤: ${baseCmd}`);
            updateRisk(risk + 4);
        }

        // å€’è®¡æ—¶
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (gameOver) return;
                if (timeLeft > 0) {
                    timeLeft -= 1;
                    updateTimerDisplay();
                    
                    const config = getDifficultyConfig();
                    if (timeLeft % config.autoInterval === 0 && timeLeft > 0) {
                        updateRisk(risk + config.autoIncrease);
                        printToScreen(`â° æ—¶é—´æµé€ï¼Œé£é™© +${config.autoIncrease}%`);
                    }
                } else {
                    checkFailureCondition();
                }
            }, 1000);
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            const config = getDifficultyConfig();
            
            risk = config.initialRisk;
            timeLeft = 300;
            gameOver = false;
            sudoObtained = false;
            dataDeleted = false;
            auditFileDeleted = false;
            bashHistoryCleared = false;
            hideCount = 0;
            hideMax = config.hideMax;
            commandHistory = [];
            
            multiLevel = {
                main: false,
                backup: false,
                replica: false,
                archive: false,
                remote: false
            };
            remoteLogDeleted = false;
            twoFactorVerified = false;
            adminOnline = false;
            currentServer = 'local';
            
            if (adminPatrolTimer) {
                clearInterval(adminPatrolTimer);
                adminPatrolTimer = null;
            }
            
            if (currentDifficulty === 'ultimate') {
                startAdminPatrol();
            }

            inputEl.disabled = false;
            inputEl.value = '';
            updateRisk(risk);
            updateTimerDisplay();
            
            let welcomeMsg = `> ç³»ç»Ÿå¯åŠ¨ä¸­...
> æ‚¨å·²é€šè¿‡è·³æ¿æœºè¿æ¥åˆ°ç”Ÿäº§ç¯å¢ƒ [10.0.0.1]
> å½“å‰éš¾åº¦: ${config.name}

âš ï¸  ${config.desc}

å¯ç”¨å‘½ä»¤:
  ls -la             æŸ¥çœ‹ç›®å½•
  cat <file>         æŸ¥çœ‹æ–‡ä»¶
  rm -rf ./data      åˆ é™¤æ•°æ®
  sudo su            ææƒ
  rm -f .hidden_audit åˆ é™¤å®¡è®¡æ—¥å¿—
  history -c         æ¸…å†å²
  hide               éšè”½ï¼ˆé™é£é™©ï¼‰
  run                è·‘è·¯`;

            if (currentDifficulty === 'ultimate') {
                welcomeMsg += `

ğŸ”° ç©¶æåœ°ç‹±é¢å¤–å‘½ä»¤:
  ssh <server>      è¿æ¥æœåŠ¡å™¨ (backup/replica/archive/log)
  who                æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·
  verify             åŒå› ç´ éªŒè¯`;
            }

            welcomeMsg += `

å¼€å§‹ä½ çš„æŒ‘æˆ˜...`;

            outputEl.innerHTML = welcomeMsg;
            
            if (timerInterval) clearInterval(timerInterval);
            startTimer();
            
            // é¦–æ¬¡æ¸¸æˆè§£é”æˆå°±
            if (stats.totalGames === 0) {
                setTimeout(() => {
                    if (!ACHIEVEMENTS.find(a => a.id === 'first_timer').unlocked) {
                        unlockAchievement('first_timer');
                    }
                }, 1000);
            }
        }

        // æˆå°±é¢æ¿æŠ˜å 
        window.toggleAchievements = function() {
            const content = document.getElementById('achievementContent');
            const icon = document.getElementById('toggleIcon');
            if (content.style.display === 'none') {
                content.style.display = 'block';
                icon.innerText = 'â–¼';
            } else {
                content.style.display = 'none';
                icon.innerText = 'â–¶';
            }
        };

        // äº‹ä»¶ç»‘å®š
        inputEl.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                const cmd = inputEl.value.trim();
                processCommand(cmd);
                inputEl.value = '';
            }
        });

        document.querySelectorAll('.cmd-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const cmd = btn.getAttribute('data-cmd');
                processCommand(cmd);
                inputEl.focus();
            });
        });

        resetBtn.addEventListener('click', resetGame);
        
        clearAchievementsBtn.addEventListener('click', () => {
            clearAchievements();
        });

        // åˆå§‹åŒ–
        loadAchievements();
        updateButtonsForDifficulty('easy');
        resetGame();
        inputEl.focus();

        // ç¡®ä¿UIæ˜¾ç¤ºæ­£ç¡®
        difficultyNameEl.innerText = 'ğŸƒ ç®€å•';
        difficultyInfoEl.innerHTML = 'âš¡ åˆå§‹é£é™©10%ï¼Œéšè”½å¯ç”¨5æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+1%/30ç§’';
        
        // åˆå§‹æ˜¾ç¤ºæˆå°±é¢æ¿
        document.getElementById('achievementContent').style.display = 'block';
    })();
</script>
</body>
</html>
