<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âš¡ åˆ åº“è·‘è·¯ âš¡</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Courier New', Courier, monospace;
        }
        body {
            background: linear-gradient(145deg, #0b1f1a 0%, #0a2a1f 100%);
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 16px;
        }
        .game-container {
            max-width: 1000px;
            width: 100%;
            background: #0f0e0b;
            border-radius: 24px;
            box-shadow: 0 20px 35px rgba(0,0,0,0.8), 0 0 0 2px #3a5f4b inset, 0 0 0 4px #1e332a inset;
            padding: 24px 20px 28px;
            border: 2px solid #6f8f72;
        }
        .terminal-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 20px;
            padding-left: 8px;
            border-bottom: 2px solid #3b6e4b;
            padding-bottom: 10px;
        }
        .terminal-header .dot {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #2e7d5a;
            box-shadow: 0 0 0 2px #5faa7a;
        }
        .terminal-header .dot.red {
            background: #ac4e3b;
            box-shadow: 0 0 0 2px #d47b62;
        }
        .terminal-header .dot.yellow {
            background: #c9a23b;
            box-shadow: 0 0 0 2px #ebc454;
        }
        .terminal-header .title {
            color: #b3f0c0;
            font-size: 1.4rem;
            font-weight: bold;
            letter-spacing: 2px;
            text-shadow: 0 0 5px #71c285;
            flex: 1;
            text-align: center;
            margin-right: 50px;
        }
        
        /* éš¾åº¦é€‰æ‹©å™¨ */
        .difficulty-selector {
            background: #0f271b;
            border: 2px solid #3f7854;
            border-radius: 16px;
            padding: 12px 16px;
            margin-bottom: 20px;
            color: #b3f0c0;
        }
        .difficulty-title {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }
        .difficulty-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .difficulty-btn {
            flex: 1;
            min-width: 100px;
            padding: 10px;
            border: 2px solid;
            border-radius: 30px;
            background: #0c1f17;
            color: #c6f7d0;
            font-weight: bold;
            cursor: pointer;
            transition: 0.1s;
            text-align: center;
        }
        .difficulty-btn.easy {
            border-color: #4f9e6a;
        }
        .difficulty-btn.easy.selected {
            background: #1f6e3a;
            border-color: #a6ffb4;
            box-shadow: 0 0 10px #5aff8c;
        }
        .difficulty-btn.normal {
            border-color: #d4a13e;
        }
        .difficulty-btn.normal.selected {
            background: #b37b2c;
            border-color: #ffd966;
            box-shadow: 0 0 10px #ffb347;
        }
        .difficulty-btn.hard {
            border-color: #c45a3b;
        }
        .difficulty-btn.hard.selected {
            background: #a13e2b;
            border-color: #ff8a6c;
            box-shadow: 0 0 10px #ff5f4a;
        }
        .difficulty-btn.hell {
            border-color: #9b3b9b;
        }
        .difficulty-btn.hell.selected {
            background: #6b2b6b;
            border-color: #d86cd8;
            box-shadow: 0 0 10px #bf3fbf;
        }
        .difficulty-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #89f7b1;
            background: #0c1f17;
            padding: 8px 12px;
            border-radius: 30px;
            border: 1px solid #3f7854;
        }
        
        .screen {
            background: #0c1f17;
            border: 3px solid #3c6e51;
            border-radius: 18px;
            padding: 20px 18px;
            min-height: 360px;
            box-shadow: inset 0 0 25px #00000099, 0 0 0 2px #5d8867;
            color: #c6f7d0;
            font-size: 1.15rem;
            line-height: 1.6;
            white-space: pre-wrap;
            word-break: break-word;
            margin-bottom: 20px;
            overflow-y: auto;
            max-height: 400px;
            scroll-behavior: smooth;
        }
        .screen::-webkit-scrollbar {
            width: 8px;
            background: #193126;
        }
        .screen::-webkit-scrollbar-thumb {
            background: #45996b;
            border-radius: 30px;
        }
        .input-area {
            background: #0b1d13;
            border-radius: 60px;
            border: 3px solid #4a7b5c;
            display: flex;
            align-items: center;
            padding: 6px 18px;
            margin-top: 12px;
            box-shadow: 0 0 0 2px #1f4a30 inset;
        }
        .prompt {
            color: #d0ffb0;
            font-weight: bold;
            font-size: 1.5rem;
            margin-right: 10px;
            text-shadow: 0 0 8px #9affb0;
        }
        #commandInput {
            background: transparent;
            border: none;
            outline: none;
            color: #e3ffe7;
            font-size: 1.4rem;
            width: 100%;
            caret-color: #66ff99;
            font-family: 'Courier New', Courier, monospace;
            font-weight: 500;
        }
        #commandInput::placeholder {
            color: #456b52;
            font-size: 1.1rem;
            font-style: italic;
        }
        .button-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 20px;
            justify-content: center;
        }
        .cmd-btn {
            background: #193d29;
            border: 2px solid #6cab7c;
            color: #dcffd3;
            font-size: 0.9rem;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 40px;
            cursor: pointer;
            transition: 0.15s;
            font-family: 'Courier New', monospace;
            box-shadow: 0 5px 0 #0e251a;
            text-transform: lowercase;
        }
        .cmd-btn:hover {
            background: #256b40;
            border-color: #9effb4;
            transform: translateY(-2px);
            box-shadow: 0 7px 0 #0e251a;
        }
        .cmd-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #0e251a;
        }
        .status-bar {
            display: flex;
            justify-content: space-between;
            color: #89f7b1;
            margin: 15px 5px 5px 5px;
            font-size: 1.2rem;
            font-weight: bold;
            background: #0f271b;
            padding: 8px 18px;
            border-radius: 40px;
            border: 1px solid #3f7854;
        }
        .danger {
            color: #ff907c;
            text-shadow: 0 0 5px #ff5f4a;
        }
        .warning {
            color: #ffb27a;
        }
        .safe {
            color: #c6f7d0;
        }
        .reset-link {
            text-align: right;
            margin-top: 10px;
        }
        .reset-link button {
            background: none;
            border: 2px solid #4e7760;
            color: #a8e6b3;
            font-size: 1rem;
            padding: 5px 18px;
            border-radius: 30px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.1s;
        }
        .reset-link button:hover {
            background: #2d5f40;
            color: white;
        }
        .footer-note {
            color: #50855e;
            text-align: center;
            margin-top: 12px;
            font-size: 0.9rem;
        }
        
        /* æˆå°±ç³»ç»Ÿæ ·å¼ */
        .achievement-panel {
            background: #0f271b;
            border: 2px solid #3f7854;
            border-radius: 16px;
            padding: 12px 16px;
            margin-bottom: 20px;
            color: #b3f0c0;
            font-size: 1rem;
        }
        .achievement-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: bold;
            font-size: 1.1rem;
            letter-spacing: 1px;
        }
        .achievement-title:hover {
            color: #e3ffe7;
        }
        .achievement-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            padding-right: 5px;
        }
        .achievement-grid::-webkit-scrollbar {
            width: 6px;
            background: #193126;
        }
        .achievement-grid::-webkit-scrollbar-thumb {
            background: #45996b;
            border-radius: 30px;
        }
        .achievement-item {
            background: #0c1f17;
            border: 1px solid #2d6b42;
            border-radius: 12px;
            padding: 6px 3px;
            text-align: center;
            font-size: 0.8rem;
            transition: 0.1s;
        }
        .achievement-item.unlocked {
            background: #1f5a36;
            border-color: #a6ffb4;
            color: #e3ffe7;
            box-shadow: 0 0 8px #5aff8c;
        }
        .achievement-item .emoji {
            font-size: 1.2rem;
            display: block;
        }
        .achievement-item .name {
            font-weight: bold;
            font-size: 0.7rem;
        }
        .achievement-item .desc {
            font-size: 0.6rem;
            color: #89c297;
        }
        .achievement-item.unlocked .desc {
            color: #dcffd3;
        }
        .stats-row {
            display: flex;
            gap: 20px;
            margin: 10px 0;
            font-size: 0.9rem;
            color: #89f7b1;
        }
        .progress-bar {
            background: #0a1f15;
            height: 6px;
            border-radius: 6px;
            margin: 10px 0 5px;
        }
        .progress-fill {
            background: #6eff96;
            height: 6px;
            border-radius: 6px;
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
<div class="game-container">
    <div class="terminal-header">
        <span class="dot red"></span>
        <span class="dot yellow"></span>
        <span class="dot"></span>
        <span class="title">rm -rf / â˜… å«ç¥¸ç³»ç»Ÿç‰ˆ</span>
    </div>

    <!-- éš¾åº¦é€‰æ‹©å™¨ -->
    <div class="difficulty-selector">
        <div class="difficulty-title">
            <span>âš¡ é€‰æ‹©éš¾åº¦ <span id="difficultyName">ç®€å•</span></span>
            <span>ğŸ† æˆå°± <span id="unlockCount">0/37</span></span>
        </div>
        <div class="difficulty-buttons">
            <div class="difficulty-btn easy selected" data-difficulty="easy" onclick="setDifficulty('easy')">ğŸƒ ç®€å•</div>
            <div class="difficulty-btn normal" data-difficulty="normal" onclick="setDifficulty('normal')">ğŸŒ² æ™®é€š</div>
            <div class="difficulty-btn hard" data-difficulty="hard" onclick="setDifficulty('hard')">ğŸ”¥ å›°éš¾</div>
            <div class="difficulty-btn hell" data-difficulty="hell" onclick="setDifficulty('hell')">ğŸ‘¿ åœ°ç‹±</div>
        </div>
        <div class="difficulty-info" id="difficultyInfo">
            ğŸƒ ç®€å•: åˆå§‹é£é™©10%ï¼Œéšè”½å¯ç”¨5æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+1%/30ç§’
        </div>
    </div>

    <!-- æˆå°±é¢æ¿ -->
    <div class="achievement-panel" id="achievementPanel">
        <div class="achievement-title" onclick="toggleAchievements()">
            <span>ğŸ† æˆå°±ç³»ç»Ÿ <span id="unlockCount2">0/37</span></span>
            <span id="toggleIcon">â–¼</span>
        </div>
        <div id="achievementContent">
            <div class="stats-row">
                <span>ğŸƒ æ€»æ¸¸æˆæ¬¡æ•°: <span id="totalGames">0</span></span>
                <span>âœ¨ Sçº§ç»“å±€: <span id="sRankCount">0</span></span>
                <span>ğŸ’€ ä½œæ­»æ¬¡æ•°: <span id="deathCount">0</span></span>
            </div>
            <div class="achievement-grid" id="achievementGrid"></div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
            </div>
        </div>
    </div>

    <!-- ä¸»å±å¹•è¾“å‡º -->
    <div class="screen" id="outputScreen">
        > ç³»ç»Ÿå¯åŠ¨ä¸­...
        > æ‚¨å·²é€šè¿‡è·³æ¿æœºè¿æ¥åˆ°ç”Ÿäº§ç¯å¢ƒ [10.0.0.1]
        >
        âš ï¸  å½“å‰ç›®å½•: /data/production/db
        âš ï¸  è·ç¦»è‡ªåŠ¨å®¡è®¡æ—¥å¿—ä¸Šä¼ è¿˜å‰© 5 åˆ†é’Ÿ
        >
        è¾“å…¥æŒ‡ä»¤å¼€å§‹ä½ çš„åˆ åº“è·‘è·¯è®¡åˆ’...
    </div>

    <!-- è¾“å…¥è¡Œ -->
    <div class="input-area">
        <span class="prompt">$</span>
        <input type="text" id="commandInput" placeholder="è¾“å…¥å‘½ä»¤ (help / run / hide / frame)" autofocus>
    </div>

    <!-- å¿«æ·æŒ‡ä»¤æŒ‰é’® -->
    <div class="button-grid">
        <button class="cmd-btn" data-cmd="ls -la">ğŸ“ ls -la</button>
        <button class="cmd-btn" data-cmd="rm -rf ./data">ğŸ’£ rm -rf ./data</button>
        <button class="cmd-btn" data-cmd="sudo su">ğŸ” sudo su</button>
        <button class="cmd-btn" data-cmd="cat config.json">ğŸ“„ cat config</button>
        <button class="cmd-btn" data-cmd="cat secret.db">ğŸ”‘ cat secret</button>
        <button class="cmd-btn" data-cmd="strings secret.db">ğŸ“ strings</button>
        <button class="cmd-btn" data-cmd="hexdump secret.db">ğŸ”¢ hexdump</button>
        <button class="cmd-btn" data-cmd="file secret.db">ğŸ“‹ file</button>
        <button class="cmd-btn" data-cmd="sqlite3 secret.db">ğŸ’¾ sqlite3</button>
        <button class="cmd-btn" data-cmd="openssl secret.db">ğŸ” openssl</button>
        <button class="cmd-btn" data-cmd="decrypt_secret">âœ¨ çœŸÂ·è§£å¯†</button>
        <button class="cmd-btn" data-cmd="./backdoor.sh">ğŸ•³ï¸ run backdoor</button>
        <button class="cmd-btn" data-cmd="history">ğŸ“œ history</button>
        <button class="cmd-btn" data-cmd="rm -f .hidden_audit">ğŸ—‘ï¸ åˆ å®¡è®¡</button>
        <button class="cmd-btn" data-cmd="history -c">ğŸ§¹ æ¸…å†å²</button>
        <button class="cmd-btn" data-cmd="frame backup">ğŸ­ å«ç¥¸backup</button>
        <button class="cmd-btn" data-cmd="frame guest">ğŸ­ å«ç¥¸guest</button>
        <button class="cmd-btn" data-cmd="run">ğŸƒ è·‘è·¯ï¼</button>
        <button class="cmd-btn" data-cmd="hide">ğŸ‘» éšè”½</button>
        <button class="cmd-btn" data-cmd="achievements">ğŸ† æˆå°±</button>
    </div>

    <!-- çŠ¶æ€æ  -->
    <div class="status-bar">
        <span>ğŸ”¥ é£é™©: <span id="riskValue" class="safe">10</span>%</span>
        <span>â³ æ—¶é—´: <span id="timerDisplay">5:00</span></span>
    </div>

    <!-- é‡ç½®æŒ‰é’® -->
    <div class="reset-link">
        <button id="resetBtn">âŸ² é‡æ–°è¿æ¥</button>
        <button id="clearAchievementsBtn" style="margin-left: 10px; background: #3d2b2b; border-color: #aa6a6a;">ğŸ—‘ï¸ æ¸…ç©ºæˆå°±</button>
    </div>
    <div class="footer-note">[ å«ç¥¸ç³»ç»Ÿç‰ˆ ] â€” æ–°å¢å«ç¥¸å‘½ä»¤ï¼Œè§£é”å½±å¸æˆå°±ï¼</div>
</div>

<script>
    (function() {
        // ------ éš¾åº¦é…ç½® ------
        const DIFFICULTY_CONFIG = {
            easy: {
                name: 'ğŸƒ ç®€å•',
                initialRisk: 10,
                hideMax: 5,
                autoIncrease: 1,
                autoInterval: 30,
                backdoorRisk: 20,
                sudoRisk: 15,
                rmRisk: 20,
                auditRisk: 15,
                desc: 'åˆå§‹é£é™©10%ï¼Œéšè”½å¯ç”¨5æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+1%/30ç§’'
            },
            normal: {
                name: 'ğŸŒ² æ™®é€š',
                initialRisk: 15,
                hideMax: 3,
                autoIncrease: 2,
                autoInterval: 30,
                backdoorRisk: 25,
                sudoRisk: 20,
                rmRisk: 25,
                auditRisk: 20,
                desc: 'åˆå§‹é£é™©15%ï¼Œéšè”½å¯ç”¨3æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+2%/30ç§’'
            },
            hard: {
                name: 'ğŸ”¥ å›°éš¾',
                initialRisk: 20,
                hideMax: 2,
                autoIncrease: 3,
                autoInterval: 30,
                backdoorRisk: 30,
                sudoRisk: 25,
                rmRisk: 30,
                auditRisk: 25,
                desc: 'åˆå§‹é£é™©20%ï¼Œéšè”½å¯ç”¨2æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+3%/30ç§’'
            },
            hell: {
                name: 'ğŸ‘¿ åœ°ç‹±',
                initialRisk: 30,
                hideMax: 1,
                autoIncrease: 4,
                autoInterval: 30,
                backdoorRisk: 35,
                sudoRisk: 30,
                rmRisk: 35,
                auditRisk: 30,
                desc: 'åˆå§‹é£é™©30%ï¼Œéšè”½ä»…1æ¬¡ï¼Œè‡ªåŠ¨å¢é•¿+4%/30ç§’'
            }
        };

        // å½“å‰éš¾åº¦
        let currentDifficulty = 'easy';

        // æ¸¸æˆçŠ¶æ€
        let risk = DIFFICULTY_CONFIG.easy.initialRisk;
        let timeLeft = 300;
        let timerInterval = null;
        let gameOver = false;
        let finalMessageShown = false;
        let sudoObtained = false;
        let dataDeleted = false;
        let auditFileDeleted = false;
        let bashHistoryCleared = false;
        let hideCount = 0;
        let hideMax = DIFFICULTY_CONFIG.easy.hideMax;
        let commandHistory = [];
        let secretBackdoorUsed = false;
        let backdoorEasterEggTriggered = false;
        let backdoorChoice = null;
        let secretDecrypted = false;
        let decryptionAttempts = 0;
        let highRiskWarningShown = false;
        
        // å«ç¥¸ç³»ç»ŸçŠ¶æ€
        let framedAccounts = {
            backup: false,
            guest: false,
            root: false
        };

        // DOM å…ƒç´ 
        const outputEl = document.getElementById('outputScreen');
        const inputEl = document.getElementById('commandInput');
        const riskSpan = document.getElementById('riskValue');
        const timerSpan = document.getElementById('timerDisplay');
        const resetBtn = document.getElementById('resetBtn');
        const clearAchievementsBtn = document.getElementById('clearAchievementsBtn');
        const difficultyNameEl = document.getElementById('difficultyName');
        const difficultyInfoEl = document.getElementById('difficultyInfo');

        // ------ 37ä¸ªæˆå°±ï¼ˆç§»é™¤äº†3ä¸ªä¸å¯ç”¨çš„ï¼Œæ–°å¢äº†å«ç¥¸æˆå°±ï¼‰------
        const ACHIEVEMENTS = [
            // åŸºç¡€ç»„ (5ä¸ª)
            { id: 'first_timer', name: 'åˆæ¬¡è·‘è·¯', emoji: 'ğŸƒ', desc: 'å®Œæˆä¸€å±€æ¸¸æˆ', unlocked: false },
            { id: 'data_deleted', name: 'åˆ åº“ä¸“å®¶', emoji: 'ğŸ’£', desc: 'åˆ é™¤dataç›®å½•', unlocked: false },
            { id: 'sudo_root', name: 'æƒé™ç‹—', emoji: 'ğŸ”', desc: 'è·å¾—rootæƒé™', unlocked: false },
            { id: 'audit_clean', name: 'ä¸ç•™ç—•è¿¹', emoji: 'ğŸ§¹', desc: 'åˆ é™¤å®¡è®¡æ—¥å¿—', unlocked: false },
            { id: 'history_clean', name: 'å¤±å¿†ç—‡', emoji: 'ğŸ“œ', desc: 'æ¸…ç©ºå‘½ä»¤å†å²', unlocked: false },
            
            // åé—¨ç»„ (3ä¸ª)
            { id: 'backdoor_used', name: 'èµ°åé—¨', emoji: 'ğŸ•³ï¸', desc: 'æ‰§è¡Œåé—¨è„šæœ¬', unlocked: false },
            { id: 'backdoor_cut', name: 'è¿·é€”çŸ¥è¿”', emoji: 'ğŸ”Œ', desc: 'åˆ‡æ–­åé—¨é€ƒç”Ÿ', unlocked: false },
            { id: 'backdoor_continue', name: 'å¤´é“å¨ƒ', emoji: 'ğŸ’€', desc: 'ç»§ç»­åé—¨ä½œæ­»', unlocked: false },
            
            // éšè”½ç»„ (2ä¸ª)
            { id: 'hide_master', name: 'èº²çŒ«çŒ«é«˜æ‰‹', emoji: 'ğŸ‘»', desc: 'ä½¿ç”¨å…¨éƒ¨éšè”½æ¬¡æ•°', unlocked: false },
            
            // ç»“å±€ç»„ (5ä¸ª)
            { id: 'perfect_crime', name: 'å®Œç¾çŠ¯ç½ª', emoji: 'âœ¨', desc: 'Sçº§ç»“å±€', unlocked: false },
            { id: 'almost_perfect', name: 'å·®ä¸€ç‚¹ç‚¹', emoji: 'ğŸ”’', desc: 'Açº§ç»“å±€', unlocked: false },
            { id: 'fugitive', name: 'äº¡å‘½å¤©æ¶¯', emoji: 'ğŸƒâ€â™‚ï¸', desc: 'Bçº§ç»“å±€', unlocked: false },
            { id: 'coward', name: 'æ‡¦å¤«', emoji: 'ğŸ˜¨', desc: 'ä»€ä¹ˆéƒ½æ²¡å¹²å°±è·‘è·¯', unlocked: false },
            { id: 'caught', name: 'å½“åœºæŠ“è·', emoji: 'ğŸš¨', desc: 'é£é™©100%è¢«æŠ“', unlocked: false },
            
            // æ—¶é—´ç»„ (3ä¸ª)
            { id: 'timeout', name: 'æ‹–å»¶ç—‡', emoji: 'â°', desc: 'æ—¶é—´è€—å°½è¢«æŠ“', unlocked: false },
            { id: 'speedster', name: 'é—ªç”µä¾ ', emoji: 'âš¡', desc: '3åˆ†é’Ÿå†…å®Œæˆæ¸¸æˆ', unlocked: false },
            { id: 'slowpoke', name: 'æ…¢ä¹Œé¾Ÿ', emoji: 'ğŸ¢', desc: 'æœ€åä¸€ç§’è·‘è·¯æˆåŠŸ', unlocked: false },
            
            // è§£å¯†ç»„ (7ä¸ª)
            { id: 'cat_config', name: 'çª¥æ¢è€…', emoji: 'ğŸ‘€', desc: 'æŸ¥çœ‹config.json', unlocked: false },
            { id: 'cat_secret', name: 'è§£å¯†å¤§å¸ˆÂ·åˆçª¥', emoji: 'ğŸ”‘', desc: 'æŸ¥çœ‹secret.db', unlocked: false },
            { id: 'cat_backdoor', name: 'è„šæœ¬å°å­', emoji: 'ğŸ“', desc: 'æŸ¥çœ‹backdoor.sh', unlocked: false },
            { id: 'true_decrypt', name: 'çœŸÂ·è§£å¯†å¤§å¸ˆ', emoji: 'ğŸ”“', desc: 'å®Œå…¨è§£å¯†secret.db', unlocked: false },
            { id: 'decrypt_master', name: 'å¯†ç ç ´è¯‘è€…', emoji: 'ğŸ—ï¸', desc: 'ä½¿ç”¨æ‰€æœ‰è§£å¯†å·¥å…·', unlocked: false },
            { id: 'data_analyst', name: 'æ•°æ®åˆ†æå¸ˆ', emoji: 'ğŸ“Š', desc: 'ä½¿ç”¨strings,hexdump,file,sqlite3,openssl', unlocked: false },
            { id: 'capitalist', name: 'èµ„æœ¬å®¶', emoji: 'ğŸ’°', desc: 'è·‘è·¯å‰å…ˆå¤‡ä»½æ•°æ®', unlocked: false },
            
            // éš¾åº¦ç»„ (5ä¸ª)
            { id: 'easy_clear', name: 'æ–°æ‰‹æ•™ç¨‹', emoji: 'ğŸƒ', desc: 'ç®€å•éš¾åº¦é€šå…³', unlocked: false },
            { id: 'normal_clear', name: 'æ­£å¸¸å‘æŒ¥', emoji: 'ğŸŒ²', desc: 'æ™®é€šéš¾åº¦é€šå…³', unlocked: false },
            { id: 'hard_clear', name: 'ç¡¬æ ¸ç©å®¶', emoji: 'ğŸ”¥', desc: 'å›°éš¾éš¾åº¦é€šå…³', unlocked: false },
            { id: 'hell_clear', name: 'åœ°ç‹±å¹¸å­˜è€…', emoji: 'ğŸ‘¿', desc: 'åœ°ç‹±éš¾åº¦é€šå…³', unlocked: false },
            { id: 'all_difficulties', name: 'å…¨éš¾åº¦åˆ¶éœ¸', emoji: 'ğŸ‘‘', desc: 'æ‰€æœ‰éš¾åº¦é€šå…³ä¸€æ¬¡', unlocked: false },
            
            // è¶£å‘³ç»„ (5ä¸ª)
            { id: 'precision', name: 'ç²¾å‡†æ‰“å‡»', emoji: 'ğŸ”ª', desc: 'åªåˆ ä¸»åº“ï¼Œä¸ç¢°å…¶ä»–æ–‡ä»¶', unlocked: false },
            { id: 'clean_freak', name: 'æ´ç™–æ‚£è€…', emoji: 'ğŸ§¹', desc: 'åˆ é™¤æ‰€æœ‰æ—¥å¿—æ–‡ä»¶', unlocked: false },
            { id: 'recycler', name: 'å¾ªç¯åˆ©ç”¨', emoji: 'ğŸ”„', desc: 'é‡å¤ä½¿ç”¨åŒä¸€å‘½ä»¤10æ¬¡', unlocked: false },
            { id: 'circus', name: 'é©¬æˆå›¢', emoji: 'ğŸª', desc: 'è§¦å‘æ‰€æœ‰å½©è›‹', unlocked: false },
            { id: 'rm_root', name: 'ä½œæ­»å°èƒ½æ‰‹', emoji: 'ğŸ’¥', desc: 'å°è¯•rm -rf /', unlocked: false },
            
            // âœ¨ æ–°å¢ï¼šå«ç¥¸ç»„ (2ä¸ª)
            { id: 'frame_master', name: 'å½±å¸', emoji: 'ğŸ­', desc: 'æˆåŠŸå«ç¥¸ç»™å…¶ä»–è´¦æˆ·', unlocked: false },
            { id: 'triple_frame', name: 'è¿ç¯è®¡', emoji: 'ğŸª', desc: 'å«ç¥¸ç»™ä¸‰ä¸ªä¸åŒè´¦æˆ·', unlocked: false }
        ];

        // ç»Ÿè®¡æ•°æ®
        let stats = {
            totalGames: 0,
            sRankCount: 0,
            deathCount: 0,
            aRankCount: 0,
            bRankCount: 0,
            difficulties: {
                easy: false,
                normal: false,
                hard: false,
                hell: false
            }
        };

        // è®°å½•æ¸¸æˆå¼€å§‹æ—¶é—´ï¼ˆç”¨äºé—ªç”µä¾ æˆå°±ï¼‰
        let gameStartTime = Date.now();

        // secret.db è§£å¯†å†…å®¹
        function getSecretContent() {
            let content = '';
            switch(currentDifficulty) {
                case 'easy':
                    content = `ğŸ”“ secret.db è§£å¯†ç»“æœ (ç®€å•éš¾åº¦):\n\nğŸ“Š æ•°æ®åº“: SQLite 3.x\nğŸ“ è¡¨æ•°é‡: 2\n\nğŸ“‹ è¡¨: users\n1|admin|5f4dcc3b5aa765d61d8327deb882cf99\n2|guest|\n\nå¯†ç : "password"`;
                    break;
                case 'normal':
                    content = `ğŸ”“ secret.db è§£å¯†ç»“æœ (æ™®é€šéš¾åº¦):\n\nğŸ“Š æ•°æ®åº“: SQLite 3.x\nğŸ“ è¡¨æ•°é‡: 3\n\nğŸ“‹ è¡¨: users\n1|admin|5f4dcc3b5aa765d61d8327deb882cf99\n2|backup|25d55ad283aa400af464c76d713c07ad\n3|root|63a9f0ea7bb98050796b649e85481845\n\nå¯†ç : admin:password, backup:12345678, root:root`;
                    break;
                case 'hard':
                    content = `ğŸ”“ secret.db è§£å¯†ç»“æœ (å›°éš¾éš¾åº¦):\n\nğŸ“Š æ•°æ®åº“: SQLite 3.x (åŠ å¯†)\nğŸ“ è¡¨æ•°é‡: 4\n\nğŸ“‹ è¡¨: users\n1|admin|$2y$10$N9qo8uLOickgx2ZMRZoMy.Mr|super_admin\n2|sysadmin|$2y$10$F0Ux5c5Z5Q5Q5Q5Q5Q5Q5Q5Q|admin\n3|backup|$2y$10$L5Q5Q5Q5Q5Q5Q5Q5Q5Q5Q5Q5Q|backup\n\nğŸ“‹ è¡¨: ssh_keys\nbackup01|-----BEGIN RSA PRIVATE KEY-----...`;
                    break;
                case 'hell':
                    content = `ğŸ”“ secret.db è§£å¯†ç»“æœ (åœ°ç‹±éš¾åº¦):\n\nğŸ”¥ åœ°ç‹±æ¨¡å¼ç‰¹æ®Šå†…å®¹ ğŸ”¥\n\nğŸ“Š æ•°æ®åº“: SQLite 3.x (AES-256åŠ å¯†)\nğŸ“ è¡¨æ•°é‡: 5\n\nğŸ“‹ è¡¨: audit_2024\n1|YOU|rm -rf ./data|JUST NOW\n2|YOU|sudo su|JUST NOW\n\nâš ï¸ ä½ çš„è§£å¯†è¡Œä¸ºå·²è¢«è®°å½•ï¼`;
                    break;
            }
            return content;
        }

        // ä»CookieåŠ è½½æˆå°±
        function loadAchievements() {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                const [name, value] = cookie.trim().split('=');
                if (name === 'frame_achievements') {
                    try {
                        const unlockedIds = JSON.parse(decodeURIComponent(value));
                        ACHIEVEMENTS.forEach(ach => {
                            ach.unlocked = unlockedIds.includes(ach.id);
                        });
                    } catch (e) {}
                } else if (name === 'frame_stats') {
                    try {
                        stats = JSON.parse(decodeURIComponent(value));
                    } catch (e) {}
                }
            }
            updateAchievementDisplay();
        }

        // ä¿å­˜æˆå°±
        function saveAchievements() {
            const unlockedIds = ACHIEVEMENTS.filter(ach => ach.unlocked).map(ach => ach.id);
            const expiryDate = new Date();
            expiryDate.setFullYear(expiryDate.getFullYear() + 1);
            document.cookie = `frame_achievements=${encodeURIComponent(JSON.stringify(unlockedIds))}; expires=${expiryDate.toUTCString()}; path=/`;
            document.cookie = `frame_stats=${encodeURIComponent(JSON.stringify(stats))}; expires=${expiryDate.toUTCString()}; path=/`;
            updateAchievementDisplay();
        }

        // è§£é”æˆå°±
        function unlockAchievement(id) {
            const achievement = ACHIEVEMENTS.find(a => a.id === id);
            if (achievement && !achievement.unlocked) {
                achievement.unlocked = true;
                printToScreen(`\nğŸ† æˆå°±è§£é”: ${achievement.emoji} ${achievement.name} - ${achievement.desc}`);
                saveAchievements();
            }
        }

        // æ›´æ–°æˆå°±æ˜¾ç¤º
        function updateAchievementDisplay() {
            const grid = document.getElementById('achievementGrid');
            if (!grid) return;
            
            let html = '';
            ACHIEVEMENTS.forEach(ach => {
                html += `
                    <div class="achievement-item ${ach.unlocked ? 'unlocked' : ''}">
                        <span class="emoji">${ach.emoji}</span>
                        <span class="name">${ach.name}</span>
                        <span class="desc">${ach.desc}</span>
                    </div>
                `;
            });
            grid.innerHTML = html;
            
            const unlockedCount = ACHIEVEMENTS.filter(a => a.unlocked).length;
            document.getElementById('unlockCount').innerText = `${unlockedCount}/37`;
            document.getElementById('unlockCount2').innerText = `${unlockedCount}/37`;
            
            const progress = (unlockedCount / 37) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            document.getElementById('totalGames').innerText = stats.totalGames;
            document.getElementById('sRankCount').innerText = stats.sRankCount;
            document.getElementById('deathCount').innerText = stats.deathCount;
        }

        // æ¸…ç©ºæˆå°±
        function clearAchievements() {
            if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æˆå°±å—ï¼Ÿ')) {
                ACHIEVEMENTS.forEach(ach => ach.unlocked = false);
                stats = { totalGames: 0, sRankCount: 0, deathCount: 0, aRankCount: 0, bRankCount: 0, difficulties: { easy: false, normal: false, hard: false, hell: false } };
                saveAchievements();
                updateAchievementDisplay();
                printToScreen('ğŸ—‘ï¸ æˆå°±æ•°æ®å·²æ¸…ç©º');
            }
        }

        // è®¾ç½®éš¾åº¦
        window.setDifficulty = function(difficulty) {
            currentDifficulty = difficulty;
            const config = DIFFICULTY_CONFIG[difficulty];
            
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            document.querySelector(`.difficulty-btn.${difficulty}`).classList.add('selected');
            
            difficultyNameEl.innerText = config.name;
            difficultyInfoEl.innerHTML = `âš¡ ${config.desc}`;
            
            resetGame();
        };

        function getDifficultyConfig() {
            return DIFFICULTY_CONFIG[currentDifficulty];
        }

        // æ‰“å°åˆ°å±å¹•
        function printToScreen(text, isCommand = false) {
            if (isCommand) {
                outputEl.innerHTML += `\n> <span style="color:#c2f2b0;">$ ${text}</span>`;
            } else {
                outputEl.innerHTML += `\n${text}`;
            }
            outputEl.scrollTop = outputEl.scrollHeight;
        }

        // æ›´æ–°é£é™©
        function updateRisk(value) {
            risk = Math.min(100, Math.max(0, value));
            riskSpan.innerText = risk + '%';
            
            if (risk >= 90) {
                riskSpan.style.color = '#ff5f4a';
                riskSpan.style.textShadow = '0 0 8px red';
                riskSpan.className = 'danger';
                if (risk >= 95 && !gameOver && !highRiskWarningShown) {
                    printToScreen('âš ï¸âš ï¸âš ï¸ é£é™©æé«˜ï¼å»ºè®®ç«‹å³è·‘è·¯ï¼è¾“å…¥ run é€ƒè·‘ âš ï¸âš ï¸âš ï¸');
                    highRiskWarningShown = true;
                }
            } else if (risk >= 70) {
                riskSpan.style.color = '#ffb27a';
                riskSpan.className = 'warning';
                highRiskWarningShown = false;
            } else {
                riskSpan.style.color = '#c6f7d0';
                riskSpan.className = 'safe';
                highRiskWarningShown = false;
            }
        }

        function updateTimerDisplay() {
            const mins = Math.floor(timeLeft / 60);
            const secs = timeLeft % 60;
            timerSpan.innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // åé—¨å½©è›‹
        function triggerBackdoorEasterEgg() {
            if (backdoorEasterEggTriggered || gameOver) return;
            backdoorEasterEggTriggered = true;
            
            let eggMessage = `
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   ğŸ¥š  ã€éšè—å½©è›‹ï¼šåé—¨é€ƒäº¡ã€‘  ğŸ¥š                         â•‘
â•‘   1. ç»§ç»­åé—¨ (é£é™©+30)                                  â•‘
â•‘   2. åˆ‡æ–­åé—¨ (é£é™©-20)                                  â•‘
â•‘  è¾“å…¥: continue_backdoor / cut_backdoor                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•`;
            printToScreen(eggMessage);
        }

        // æ¸¸æˆç»“æŸ
        function triggerEnding(message, isSuccess = false) {
            if (gameOver) return;
            
            stats.totalGames++;
            
            // æ£€æŸ¥é—ªç”µä¾ æˆå°± (3åˆ†é’Ÿå†…)
            if (Date.now() - gameStartTime < 180000) {
                unlockAchievement('speedster');
            }
            
            // æ£€æŸ¥æ…¢ä¹Œé¾Ÿæˆå°± (æœ€åä¸€ç§’)
            if (timeLeft <= 1) {
                unlockAchievement('slowpoke');
            }
            
            if (isSuccess) {
                stats.difficulties[currentDifficulty] = true;
                unlockAchievement(currentDifficulty + '_clear');
                
                if (stats.difficulties.easy && stats.difficulties.normal && stats.difficulties.hard && stats.difficulties.hell) {
                    unlockAchievement('all_difficulties');
                }
            }
            
            let endingMsg = message;
            if (!message) {
                if (risk >= 100) {
                    endingMsg = 'ğŸš¨ é£é™©100% â€”â€” ä½ è¢«å½“åœºæŠ“è·ï¼';
                    unlockAchievement('caught');
                    stats.deathCount++;
                } else if (timeLeft <= 0) {
                    endingMsg = 'â° æ—¶é—´è€—å°½ï¼Œå®¡è®¡äººå‘˜æ¨é—¨è€Œå…¥ï¼';
                    unlockAchievement('timeout');
                    stats.deathCount++;
                } else if (dataDeleted && auditFileDeleted && bashHistoryCleared) {
                    endingMsg = 'âœ¨ å®Œç¾çŠ¯ç½ªï¼ä½ æˆåŠŸè·‘è·¯äº†ï¼';
                    unlockAchievement('perfect_crime');
                    stats.sRankCount++;
                    
                    // æ£€æŸ¥ç²¾å‡†æ‰“å‡»æˆå°±
                    if (dataDeleted && !secretBackdoorUsed && !sudoObtained && commandHistory.length <= 3) {
                        unlockAchievement('precision');
                    }
                } else if (dataDeleted && auditFileDeleted) {
                    endingMsg = 'ğŸ”’ æ•°æ®å·²åˆ é™¤ï¼Œå®¡è®¡æ—¥å¿—å·²æ¸…ç©ºï¼Œä½†å‘½ä»¤å†å²è¿˜åœ¨...';
                    unlockAchievement('almost_perfect');
                    stats.aRankCount++;
                } else if (dataDeleted) {
                    endingMsg = 'âš ï¸ ä½ åˆ é™¤äº†æ•°æ®ï¼Œä½†æ—¥å¿—è¿˜åœ¨ï¼';
                    unlockAchievement('fugitive');
                    stats.bRankCount++;
                } else {
                    endingMsg = 'ğŸ˜¨ ä½ ä»€ä¹ˆéƒ½æ²¡å¹²å°±è·‘äº†...';
                    unlockAchievement('coward');
                }
            }
            
            outputEl.innerHTML += `\n==========================================\n${endingMsg}\n==========================================`;
            
            gameOver = true;
            if (timerInterval) clearInterval(timerInterval);
            inputEl.disabled = true;
            saveAchievements();
        }

        function checkFailureCondition() {
            if (gameOver) return true;
            if (risk >= 100) {
                triggerEnding();
                return true;
            }
            if (timeLeft <= 0) {
                triggerEnding();
                return true;
            }
            return false;
        }

        // è§£å¯†å·¥å…·è®°å½•
        let decryptionTools = {
            strings: false,
            hexdump: false,
            file: false,
            sqlite3: false,
            openssl: false,
            decrypt: false
        };

        function checkDecryptMaster() {
            if (decryptionTools.strings && decryptionTools.hexdump && decryptionTools.file && 
                decryptionTools.sqlite3 && decryptionTools.openssl && decryptionTools.decrypt) {
                unlockAchievement('decrypt_master');
                unlockAchievement('data_analyst');
            }
        }

        // å‘½ä»¤è®¡æ•°ï¼ˆç”¨äºå¾ªç¯åˆ©ç”¨æˆå°±ï¼‰
        let commandCounts = {};

        // å¤„ç†å‘½ä»¤
        function processCommand(cmd) {
            if (gameOver) {
                printToScreen('æ¸¸æˆå·²ç»“æŸï¼Œè¯·ç‚¹å‡»é‡æ–°è¿æ¥');
                return;
            }

            const originalCmd = cmd;
            const lowerCmd = cmd.toLowerCase().trim();
            if (lowerCmd === '') return;

            commandHistory.push(originalCmd);
            
            // å‘½ä»¤è®¡æ•°
            commandCounts[lowerCmd] = (commandCounts[lowerCmd] || 0) + 1;
            if (commandCounts[lowerCmd] === 10) {
                unlockAchievement('recycler');
            }

            printToScreen(originalCmd, true);

            const parts = originalCmd.trim().split(' ');
            const baseCmd = parts[0].toLowerCase();
            
            const config = getDifficultyConfig();

            // help
            if (baseCmd === 'help') {
                printToScreen('å¯ç”¨å‘½ä»¤:');
                printToScreen('  ls [-la]              æŸ¥çœ‹ç›®å½•');
                printToScreen('  cat <file>            æŸ¥çœ‹æ–‡ä»¶');
                printToScreen('  rm -rf <dir>          åˆ é™¤ç›®å½•');
                printToScreen('  rm -f <file>          åˆ é™¤æ–‡ä»¶');
                printToScreen('  sudo su               ææƒ');
                printToScreen('  ./backdoor.sh         æ‰§è¡Œåé—¨');
                printToScreen('  frame <user>          å«ç¥¸ (backup/guest/root)');
                printToScreen('  history/history -c    å†å²/æ¸…ç©º');
                printToScreen('  hide                   éšè”½');
                printToScreen('  run                    è·‘è·¯');
                printToScreen('  ğŸ”‘ è§£å¯†å‘½ä»¤: strings/hexdump/file/sqlite3/openssl/decrypt_secret');
                return;
            }

            // frame å«ç¥¸ç³»ç»Ÿ
            if (baseCmd === 'frame') {
                const target = parts[1];
                if (target === 'backup' || target === 'guest' || target === 'root') {
                    if (target === 'root' && !sudoObtained) {
                        printToScreen('âŒ å«ç¥¸rootéœ€è¦rootæƒé™');
                        return;
                    }
                    
                    if (!framedAccounts[target]) {
                        framedAccounts[target] = true;
                        printToScreen(`ğŸ­ æˆåŠŸå«ç¥¸ç»™ ${target} è´¦æˆ·ï¼å®¡è®¡æ—¥å¿—å·²è¢«ç¯¡æ”¹`);
                        updateRisk(risk + 10);
                        
                        // æ£€æŸ¥å«ç¥¸æˆå°±
                        let framedCount = Object.values(framedAccounts).filter(v => v).length;
                        if (framedCount >= 1) {
                            unlockAchievement('frame_master');
                        }
                        if (framedCount >= 3) {
                            unlockAchievement('triple_frame');
                        }
                    } else {
                        printToScreen(`${target} å·²ç»è¢«å«ç¥¸è¿‡äº†`);
                    }
                } else {
                    printToScreen('å¯ç”¨ç›®æ ‡: backup, guest, root (rootéœ€è¦sudo)');
                }
                return;
            }

            // å…¶ä»–å‘½ä»¤ä¿æŒä¸å˜ï¼ˆä»åŸè§£å¯†å¤§å¸ˆç‰ˆå¤åˆ¶ï¼‰
            // ls
            if (baseCmd === 'ls') {
                let option = parts[1] || '';
                if (option === '-la' || option === '-l') {
                    let fileList = 'total 64\n';
                    fileList += 'drwxr-x---  7 root  root    4096 .\n..\n';
                    fileList += '-rw-r--r--  1 db    db      1223 config.json\n';
                    fileList += '-rw-------  1 db    db     32768 secret.db\n';
                    if (!dataDeleted) fileList += 'drwx------  2 db    db      4096 data\n';
                    fileList += '-rwxr-xr-x  1 db    db       214 backdoor.sh\n';
                    if (!auditFileDeleted) fileList += '--w-------  1 root  root       6 .hidden_audit\n';
                    printToScreen(fileList);
                    updateRisk(risk + 1);
                } else {
                    let fileList = 'config.json  secret.db  ';
                    if (!dataDeleted) fileList += 'data  ';
                    fileList += 'backdoor.sh';
                    printToScreen(fileList);
                }
                return;
            }

            // cat
            if (baseCmd === 'cat') {
                if (parts.length < 2) {
                    printToScreen('ç”¨æ³•: cat <æ–‡ä»¶å>');
                } else {
                    const file = parts[1];
                    if (file === 'config.json') {
                        printToScreen('{ "database": "production", "password": "secret" }');
                        updateRisk(risk + 5);
                        unlockAchievement('cat_config');
                    } else if (file === 'secret.db') {
                        printToScreen('ï¿½ äºŒè¿›åˆ¶æ•°æ®ä¹±ç ... éœ€è¦è§£å¯†å·¥å…·');
                        updateRisk(risk + 3);
                        unlockAchievement('cat_secret');
                    } else if (file === 'backdoor.sh') {
                        printToScreen('#!/bin/bash\necho "åé—¨è„šæœ¬"');
                        updateRisk(risk + 8);
                        unlockAchievement('cat_backdoor');
                    } else if (file === '.hidden_audit') {
                        if (auditFileDeleted) {
                            printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
                        } else {
                            printToScreen('å®¡è®¡æ—¥å¿—: è®°å½•äº†ä½ çš„æ“ä½œ');
                            updateRisk(risk + 1);
                        }
                    } else {
                        printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
                        updateRisk(risk + 1);
                    }
                }
                return;
            }

            // è§£å¯†å‘½ä»¤
            if (baseCmd === 'strings' && parts[1] === 'secret.db') {
                printToScreen('ğŸ”¤ stringsè¾“å‡º: SQLite format 3, users, admin, 5f4dcc3b5aa765d61d8327deb882cf99');
                updateRisk(risk + 5);
                decryptionTools.strings = true;
                checkDecryptMaster();
                return;
            }

            if (baseCmd === 'hexdump' && parts[1] === 'secret.db') {
                printToScreen('ğŸ”¢ hexdump: 53 51 4c 69 74 65 20 66 6f 72 6d 61 74 20 33 00');
                updateRisk(risk + 4);
                decryptionTools.hexdump = true;
                checkDecryptMaster();
                return;
            }

            if (baseCmd === 'file' && parts[1] === 'secret.db') {
                printToScreen('ğŸ“‹ file: SQLite 3.x database, encrypted');
                updateRisk(risk + 2);
                decryptionTools.file = true;
                checkDecryptMaster();
                return;
            }

            if (baseCmd === 'sqlite3' && parts[1] === 'secret.db') {
                printToScreen('ğŸ’¾ SQLiteåˆ†æ: å‘ç°usersè¡¨, configè¡¨');
                updateRisk(risk + 8);
                decryptionTools.sqlite3 = true;
                checkDecryptMaster();
                return;
            }

            if (baseCmd === 'openssl' && parts[1] === 'secret.db') {
                printToScreen('ğŸ” opensslè§£å¯†å°è¯•... å¯†ç  "backup123" æˆåŠŸï¼');
                updateRisk(risk + 15);
                decryptionTools.openssl = true;
                checkDecryptMaster();
                return;
            }

            if (baseCmd === 'decrypt_secret') {
                if (!secretDecrypted) {
                    printToScreen('âœ¨ å®Œå…¨è§£å¯†æˆåŠŸï¼');
                    secretDecrypted = true;
                    decryptionTools.decrypt = true;
                    unlockAchievement('true_decrypt');
                    checkDecryptMaster();
                }
                printToScreen(getSecretContent());
                updateRisk(risk + 8);
                
                // æ£€æŸ¥èµ„æœ¬å®¶æˆå°±ï¼ˆå¤‡ä»½è¿‡æ•°æ®ï¼‰
                if (commandHistory.some(c => c.includes('cp') || c.includes('backup'))) {
                    unlockAchievement('capitalist');
                }
                return;
            }

            // rm -rf
            if (baseCmd === 'rm' && parts[1] === '-rf') {
                const target = parts[2];
                if (target === './data' || target === 'data') {
                    if (!dataDeleted) {
                        printToScreen('âš ï¸ æ­£åœ¨åˆ é™¤ data ç›®å½•...');
                        printToScreen('âœ… æ•°æ®å·²åˆ é™¤ï¼ä½†æ“ä½œæ—¥å¿—è¢«è®°å½•ã€‚');
                        dataDeleted = true;
                        updateRisk(risk + config.rmRisk);
                        unlockAchievement('data_deleted');
                    }
                } else if (target === '/' || target === '/*') {
                    printToScreen('å“ˆå“ˆï¼Œæƒ³åˆ æ ¹ï¼Ÿæƒé™ä¸è¶³');
                    updateRisk(risk + 40);
                    unlockAchievement('rm_root');
                } else {
                    printToScreen('æ–‡ä»¶ä¸å­˜åœ¨');
                    updateRisk(risk + 2);
                }
                return;
            }

            // rm -f
            if (baseCmd === 'rm' && parts[1] === '-f' && parts[2] === '.hidden_audit') {
                if (!auditFileDeleted) {
                    printToScreen('âœ… æœ¬åœ°å®¡è®¡æ—¥å¿—å·²åˆ é™¤');
                    auditFileDeleted = true;
                    updateRisk(risk + config.auditRisk);
                    unlockAchievement('audit_clean');
                }
                return;
            }

            // sudo su
            if (baseCmd === 'sudo' && parts[1] === 'su') {
                if (sudoObtained) {
                    printToScreen('å·²ç»æ˜¯root');
                } else {
                    printToScreen('[sudo] password: ');
                    printToScreen('âœ… ææƒæˆåŠŸ');
                    sudoObtained = true;
                    updateRisk(risk + config.sudoRisk);
                    unlockAchievement('sudo_root');
                }
                return;
            }

            // åé—¨
            if (baseCmd === './backdoor.sh') {
                if (!sudoObtained) {
                    printToScreen('æƒé™ä¸å¤Ÿ');
                    updateRisk(risk + 5);
                } else {
                    printToScreen('ğŸ•³ï¸ åé—¨å·²æ‰§è¡Œ');
                    secretBackdoorUsed = true;
                    updateRisk(risk + config.backdoorRisk);
                    unlockAchievement('backdoor_used');
                    if (dataDeleted && !backdoorEasterEggTriggered) {
                        triggerBackdoorEasterEgg();
                    }
                }
                return;
            }

            // åé—¨å½©è›‹é€‰é¡¹
            if (baseCmd === 'continue_backdoor') {
                if (!backdoorEasterEggTriggered) {
                    printToScreen('æœªè§¦å‘åé—¨å½©è›‹');
                } else {
                    printToScreen('ğŸ•³ï¸ ç»§ç»­åé—¨... é£é™©é£™å‡ï¼');
                    updateRisk(risk + 30);
                    unlockAchievement('backdoor_continue');
                    if (risk >= 100) triggerEnding();
                }
                return;
            }

            if (baseCmd === 'cut_backdoor') {
                if (!backdoorEasterEggTriggered) {
                    printToScreen('æœªè§¦å‘åé—¨å½©è›‹');
                } else {
                    printToScreen('ğŸ”Œ åˆ‡æ–­åé—¨ï¼Œé£é™©é™ä½');
                    updateRisk(risk - 20);
                    unlockAchievement('backdoor_cut');
                }
                return;
            }

            // history
            if (baseCmd === 'history') {
                if (parts[1] === '-c') {
                    printToScreen('âœ… å†å²å·²æ¸…ç©º');
                    commandHistory = [];
                    bashHistoryCleared = true;
                    updateRisk(risk + 1);
                    unlockAchievement('history_clean');
                } else {
                    commandHistory.forEach((c, i) => printToScreen(`  ${i+1}  ${c}`));
                }
                return;
            }

            // hide
            if (baseCmd === 'hide') {
                if (hideCount >= hideMax) {
                    printToScreen(`ä¸èƒ½å†èº²äº†ï¼ˆæœ€å¤§${hideMax}æ¬¡ï¼‰`);
                } else {
                    hideCount++;
                    printToScreen('ğŸ‘» é£é™©é™ä½äº†ï¼');
                    updateRisk(risk - 15);
                    if (hideCount === hideMax) unlockAchievement('hide_master');
                }
                return;
            }

            // clear
            if (baseCmd === 'clear') {
                outputEl.innerHTML = '--- å±å¹•å·²æ¸…ç©º ---';
                return;
            }

            // run
            if (baseCmd === 'run') {
                triggerEnding('', true);
                return;
            }

            printToScreen(`æœªçŸ¥å‘½ä»¤: ${baseCmd}`);
            updateRisk(risk + 4);
        }

        // å€’è®¡æ—¶
        function startTimer() {
            if (timerInterval) clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (gameOver) return;
                if (timeLeft > 0) {
                    timeLeft -= 1;
                    updateTimerDisplay();
                    
                    const config = getDifficultyConfig();
                    if (timeLeft % config.autoInterval === 0 && timeLeft > 0) {
                        updateRisk(risk + config.autoIncrease);
                    }
                } else {
                    checkFailureCondition();
                }
            }, 1000);
        }

        // é‡ç½®æ¸¸æˆ
        function resetGame() {
            const config = getDifficultyConfig();
            
            risk = config.initialRisk;
            timeLeft = 300;
            gameOver = false;
            sudoObtained = false;
            dataDeleted = false;
            auditFileDeleted = false;
            bashHistoryCleared = false;
            hideCount = 0;
            hideMax = config.hideMax;
            commandHistory = [];
            secretBackdoorUsed = false;
            backdoorEasterEggTriggered = false;
            secretDecrypted = false;
            decryptionTools = { strings: false, hexdump: false, file: false, sqlite3: false, openssl: false, decrypt: false };
            framedAccounts = { backup: false, guest: false, root: false };
            commandCounts = {};
            gameStartTime = Date.now();

            inputEl.disabled = false;
            inputEl.value = '';
            updateRisk(risk);
            updateTimerDisplay();
            
            let welcomeMsg = `> ç³»ç»Ÿå¯åŠ¨ä¸­...
> å½“å‰éš¾åº¦: ${config.name}
> å¯ç”¨å‘½ä»¤: ls, cat, rm, sudo, hide, run, frame
> è§£å¯†å‘½ä»¤: strings/hexdump/file/sqlite3/openssl/decrypt_secret
> å«ç¥¸å‘½ä»¤: frame backup/guest/root

å¼€å§‹ä½ çš„æŒ‘æˆ˜...`;
            outputEl.innerHTML = welcomeMsg;
            
            if (timerInterval) clearInterval(timerInterval);
            startTimer();
        }

        // äº‹ä»¶ç»‘å®š
        inputEl.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                processCommand(inputEl.value.trim());
                inputEl.value = '';
            }
        });

        document.querySelectorAll('.cmd-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                processCommand(btn.getAttribute('data-cmd'));
                inputEl.focus();
            });
        });

        resetBtn.addEventListener('click', resetGame);
        clearAchievementsBtn.addEventListener('click', clearAchievements);

        window.toggleAchievements = function() {
            const content = document.getElementById('achievementContent');
            const icon = document.getElementById('toggleIcon');
            content.style.display = content.style.display === 'none' ? 'block' : 'none';
            icon.innerText = content.style.display === 'none' ? 'â–¶' : 'â–¼';
        };

        // åˆå§‹åŒ–
        loadAchievements();
        resetGame();
        inputEl.focus();
    })();
</script>
</body>
</html>
